<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Atmospheric Fundamentals ¬∑ EnvironmentalTransport.jl</title><meta name="title" content="Atmospheric Fundamentals ¬∑ EnvironmentalTransport.jl"/><meta property="og:title" content="Atmospheric Fundamentals ¬∑ EnvironmentalTransport.jl"/><meta property="twitter:title" content="Atmospheric Fundamentals ¬∑ EnvironmentalTransport.jl"/><meta name="description" content="Documentation for EnvironmentalTransport.jl."/><meta property="og:description" content="Documentation for EnvironmentalTransport.jl."/><meta property="twitter:description" content="Documentation for EnvironmentalTransport.jl."/><meta property="og:url" content="https://EarthSciML.github.io/EnvironmentalTransport.jl/seinfeld_pandis_ch1/"/><meta property="twitter:url" content="https://EarthSciML.github.io/EnvironmentalTransport.jl/seinfeld_pandis_ch1/"/><link rel="canonical" href="https://EarthSciML.github.io/EnvironmentalTransport.jl/seinfeld_pandis_ch1/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">EnvironmentalTransport.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../advection/">Advection</a></li><li><a class="tocitem" href="../puff/">Puff Model</a></li><li class="is-active"><a class="tocitem" href>Atmospheric Fundamentals</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li></ul></li><li><a class="tocitem" href="../local_scale_meteorology/">Local Scale Meteorology</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../benchmarks/">üîó Benchmarks</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Atmospheric Fundamentals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Atmospheric Fundamentals</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EarthSciML/EnvironmentalTransport.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/main/docs/src/seinfeld_pandis_ch1.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Atmospheric-Fundamentals"><a class="docs-heading-anchor" href="#Atmospheric-Fundamentals">Atmospheric Fundamentals</a><a id="Atmospheric-Fundamentals-1"></a><a class="docs-heading-anchor-permalink" href="#Atmospheric-Fundamentals" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>This module implements the fundamental atmospheric equations from Chapter 1 of Seinfeld and Pandis (2006). These equations describe the basic physical and thermodynamic properties of Earth&#39;s atmosphere, including pressure distribution, temperature profiles, and concentration units. They form the foundation for atmospheric chemistry and physics modeling.</p><p>The implementation provides ModelingToolkit.jl components for:</p><ul><li><strong>Hydrostatic equilibrium</strong>: The vertical pressure gradient in the atmosphere (Eq. 1.1)</li><li><strong>Ideal gas law</strong>: Air density from pressure and temperature (Eq. 1.2)</li><li><strong>Scale height</strong>: Characteristic altitude for pressure decrease (Eq. 1.4)</li><li><strong>Barometric formula</strong>: Pressure-altitude relationship for isothermal atmosphere (Eq. 1.5)</li><li><strong>Concentration units</strong>: Volume mixing ratio and molar concentration (Eq. 1.6-1.8)</li><li><strong>Water vapor</strong>: Saturation vapor pressure and relative humidity (Eq. 1.9-1.10)</li></ul><p><strong>Reference</strong>: Seinfeld, J.H. and Pandis, S.N. (2006). <em>Atmospheric Chemistry and Physics: From Air Pollution to Climate Change</em>, 2nd Edition, Chapter 1: The Atmosphere. John Wiley &amp; Sons, Inc.</p><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.IdealGasLaw"><a class="docstring-binding" href="#EnvironmentalTransport.IdealGasLaw"><code>EnvironmentalTransport.IdealGasLaw</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">IdealGasLaw(; name=:IdealGasLaw)</code></pre><p>Calculates air density from pressure and temperature using the ideal gas law.</p><p>Implements Equation 1.2: rho = M_air * p / (R * T)</p><p>where:</p><ul><li>rho: air density (kg/m^3)</li><li>M_air: molecular weight of dry air (kg/mol)</li><li>p: atmospheric pressure (Pa)</li><li>R: universal gas constant (J/(mol*K))</li><li>T: temperature (K)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/122b0ee746226ccef16ee308d16a94c5d1e3705e/src/seinfeld_pandis_ch1.jl#L52-L67">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.ScaleHeight"><a class="docstring-binding" href="#EnvironmentalTransport.ScaleHeight"><code>EnvironmentalTransport.ScaleHeight</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ScaleHeight(; name=:ScaleHeight)</code></pre><p>Calculates the atmospheric scale height.</p><p>Implements Equation 1.4: H = R * T / (M_air * g)</p><p>The scale height H represents the altitude increase over which pressure decreases by a factor of e (~2.718).</p><p>Typical values:</p><ul><li>At T = 253 K: H = 7.4 km</li><li>At T = 288 K (sea level): H = 8.4 km</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/122b0ee746226ccef16ee308d16a94c5d1e3705e/src/seinfeld_pandis_ch1.jl#L93-L108">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.AtmosphericPressureProfile"><a class="docstring-binding" href="#EnvironmentalTransport.AtmosphericPressureProfile"><code>EnvironmentalTransport.AtmosphericPressureProfile</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">AtmosphericPressureProfile(; name=:AtmosphericPressureProfile)</code></pre><p>Calculates atmospheric pressure as a function of altitude for an isothermal atmosphere.</p><p>Implements:</p><ul><li>Equation 1.1: dp/dz = -rho * g (hydrostatic equation)</li><li>Equation 1.3: dp/dz = -M_air * g * p / (R * T) (combined form)</li><li>Equation 1.5: p(z)/p_0 = exp(-z/H) (barometric formula, isothermal case)</li></ul><p>This component uses the barometric formula (Eq. 1.5) which is the integrated form of the hydrostatic equation for an isothermal atmosphere.</p><p>Note: For a non-isothermal atmosphere, the scale height varies with altitude and numerical integration of Eq. 1.3 would be required.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/122b0ee746226ccef16ee308d16a94c5d1e3705e/src/seinfeld_pandis_ch1.jl#L134-L150">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.BarometricFormula"><a class="docstring-binding" href="#EnvironmentalTransport.BarometricFormula"><code>EnvironmentalTransport.BarometricFormula</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">BarometricFormula(; name=:BarometricFormula)</code></pre><p>Calculates pressure at a given altitude using the barometric formula.</p><p>Implements Equation 1.5: p(z) = p_0 * exp(-z/H)</p><p>This is the integrated form of the hydrostatic equation for an isothermal atmosphere. The scale height H is provided as an input.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/122b0ee746226ccef16ee308d16a94c5d1e3705e/src/seinfeld_pandis_ch1.jl#L190-L200">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.TotalMolarConcentration"><a class="docstring-binding" href="#EnvironmentalTransport.TotalMolarConcentration"><code>EnvironmentalTransport.TotalMolarConcentration</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">TotalMolarConcentration(; name=:TotalMolarConcentration)</code></pre><p>Calculates total molar concentration of air from pressure and temperature.</p><p>Implements Equation 1.7: c_total = N/V = p / (R * T)</p><p>Standard values:</p><ul><li>At STP (T=273.15 K, p=101325 Pa): c_total = 44.6 mol/m^3</li><li>At T=298 K, p=101325 Pa: c_total = 40.9 mol/m^3</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/122b0ee746226ccef16ee308d16a94c5d1e3705e/src/seinfeld_pandis_ch1.jl#L231-L243">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.MixingRatio"><a class="docstring-binding" href="#EnvironmentalTransport.MixingRatio"><code>EnvironmentalTransport.MixingRatio</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">MixingRatio(; name=:MixingRatio)</code></pre><p>Calculates the volume (mole) mixing ratio of a species.</p><p>Implements Equation 1.6: xi<em>i = c</em>i / c_total</p><p>The mixing ratio is dimensionless and typically expressed in ppm, ppb, or ppt.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/122b0ee746226ccef16ee308d16a94c5d1e3705e/src/seinfeld_pandis_ch1.jl#L268-L277">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.PartialPressureMixingRatio"><a class="docstring-binding" href="#EnvironmentalTransport.PartialPressureMixingRatio"><code>EnvironmentalTransport.PartialPressureMixingRatio</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PartialPressureMixingRatio(; name=:PartialPressureMixingRatio)</code></pre><p>Relates mixing ratio to partial pressure.</p><p>Implements Equation 1.8: xi<em>i = c</em>i / (p/(R*T)) = p_i / p</p><p>The mixing ratio equals the ratio of partial pressure to total pressure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/122b0ee746226ccef16ee308d16a94c5d1e3705e/src/seinfeld_pandis_ch1.jl#L298-L307">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.SaturationVaporPressure"><a class="docstring-binding" href="#EnvironmentalTransport.SaturationVaporPressure"><code>EnvironmentalTransport.SaturationVaporPressure</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SaturationVaporPressure(; name=:SaturationVaporPressure)</code></pre><p>Calculates the saturation vapor pressure of water as a function of temperature.</p><p>Implements Equation 1.10: p<em>H2O</em>sat(T) = 1013.25 * exp(13.3185<em>a - 1.9760</em>a^2 - 0.6445<em>a^3 - 0.1299</em>a^4)</p><p>where: a = 1 - 373.15/T</p><p>This empirical formula is valid for liquid water (T &gt; 273 K).</p><p>Note: The original equation gives pressure in mbar. Here we convert to Pa for consistency with SI units: p<em>sat (Pa) = 100 * p</em>sat (mbar)</p><p>Reference values:</p><ul><li>At T = 273 K: p_sat ~ 611 Pa (6.1 mbar)</li><li>At T = 298 K: p_sat ~ 3170 Pa (31.7 mbar)</li><li>At T = 373 K: p_sat = 101325 Pa (1013.25 mbar, boiling point)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/122b0ee746226ccef16ee308d16a94c5d1e3705e/src/seinfeld_pandis_ch1.jl#L329-L350">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.RelativeHumidity"><a class="docstring-binding" href="#EnvironmentalTransport.RelativeHumidity"><code>EnvironmentalTransport.RelativeHumidity</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">RelativeHumidity(; name=:RelativeHumidity)</code></pre><p>Calculates relative humidity from water vapor partial pressure and saturation vapor pressure.</p><p>Implements Equation 1.9: RH = 100 * p<em>H2O / p</em>H2O_sat</p><p>Relative humidity is expressed as a percentage (0-100%), stored as a dimensionless ratio multiplied by 100.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/122b0ee746226ccef16ee308d16a94c5d1e3705e/src/seinfeld_pandis_ch1.jl#L385-L396">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.AtmosphericThermodynamics"><a class="docstring-binding" href="#EnvironmentalTransport.AtmosphericThermodynamics"><code>EnvironmentalTransport.AtmosphericThermodynamics</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">AtmosphericThermodynamics(; name=:AtmosphericThermodynamics)</code></pre><p>Complete atmospheric thermodynamics system combining:</p><ul><li>Equation 1.2: Ideal gas law for density</li><li>Equation 1.4: Scale height</li><li>Equation 1.5: Barometric formula</li><li>Equation 1.7: Total molar concentration</li></ul><p>This composite system calculates pressure, density, scale height, and total molar concentration given altitude and temperature for an isothermal atmosphere.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/122b0ee746226ccef16ee308d16a94c5d1e3705e/src/seinfeld_pandis_ch1.jl#L465-L478">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.WaterVaporThermodynamics"><a class="docstring-binding" href="#EnvironmentalTransport.WaterVaporThermodynamics"><code>EnvironmentalTransport.WaterVaporThermodynamics</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">WaterVaporThermodynamics(; name=:WaterVaporThermodynamics)</code></pre><p>Complete water vapor thermodynamics system combining:</p><ul><li>Equation 1.10: Saturation vapor pressure</li><li>Equation 1.9: Relative humidity</li></ul><p>This composite system calculates relative humidity given temperature and water vapor partial pressure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/122b0ee746226ccef16ee308d16a94c5d1e3705e/src/seinfeld_pandis_ch1.jl#L422-L432">source</a></section></details></article><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><pre><code class="language-julia hljs">using EnvironmentalTransport
using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities
using ModelingToolkit: @named</code></pre><h3 id="Ideal-Gas-Law-(Eq.-1.2)"><a class="docs-heading-anchor" href="#Ideal-Gas-Law-(Eq.-1.2)">Ideal Gas Law (Eq. 1.2)</a><a id="Ideal-Gas-Law-(Eq.-1.2)-1"></a><a class="docs-heading-anchor-permalink" href="#Ideal-Gas-Law-(Eq.-1.2)" title="Permalink"></a></h3><p>The ideal gas law relates air density to pressure and temperature:</p><p class="math-container">\[\rho = \frac{M_{air} \cdot p}{R \cdot T}\]</p><h4 id="State-Variables"><a class="docs-heading-anchor" href="#State-Variables">State Variables</a><a id="State-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#State-Variables" title="Permalink"></a></h4><pre><code class="language-julia hljs">@named sys = IdealGasLaw()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>3√ó3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">rho</td><td style = "text-align: left;">1.0 m‚Åª¬≥ kg</td><td style = "text-align: left;">Air density</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">p</td><td style = "text-align: left;">1.0 m‚Åª¬π kg s‚Åª¬≤</td><td style = "text-align: left;">Atmospheric pressure</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">T</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Temperature</td></tr></tbody></table></div><h4 id="Equations"><a class="docs-heading-anchor" href="#Equations">Equations</a><a id="Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Equations" title="Permalink"></a></h4><pre><code class="language-julia hljs">equations(sys)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{rho}\left( t \right) &amp;= \frac{\mathtt{M\_air} p\left( t \right)}{R T\left( t \right)}
\end{align}
 \]</p><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h3 id="Scale-Height-(Eq.-1.4)"><a class="docs-heading-anchor" href="#Scale-Height-(Eq.-1.4)">Scale Height (Eq. 1.4)</a><a id="Scale-Height-(Eq.-1.4)-1"></a><a class="docs-heading-anchor-permalink" href="#Scale-Height-(Eq.-1.4)" title="Permalink"></a></h3><p>The scale height represents the altitude increase over which pressure decreases by a factor of <span>$e$</span> (~2.718):</p><p class="math-container">\[H = \frac{R \cdot T}{M_{air} \cdot g}\]</p><h4 id="State-Variables-2"><a class="docs-heading-anchor" href="#State-Variables-2">State Variables</a><a class="docs-heading-anchor-permalink" href="#State-Variables-2" title="Permalink"></a></h4><pre><code class="language-julia hljs">@named sys = ScaleHeight()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>2√ó3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">H</td><td style = "text-align: left;">1.0 m</td><td style = "text-align: left;">Scale height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">T</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Temperature</td></tr></tbody></table></div><h4 id="Equations-2"><a class="docs-heading-anchor" href="#Equations-2">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-2" title="Permalink"></a></h4><pre><code class="language-julia hljs">equations(sys)</code></pre><p class="math-container">\[ \begin{align}
H\left( t \right) &amp;= \frac{R T\left( t \right)}{\mathtt{M\_air} g}
\end{align}
 \]</p><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h3 id="Atmospheric-Pressure-Profile-(Eq.-1.1,-1.3,-1.5)"><a class="docs-heading-anchor" href="#Atmospheric-Pressure-Profile-(Eq.-1.1,-1.3,-1.5)">Atmospheric Pressure Profile (Eq. 1.1, 1.3, 1.5)</a><a id="Atmospheric-Pressure-Profile-(Eq.-1.1,-1.3,-1.5)-1"></a><a class="docs-heading-anchor-permalink" href="#Atmospheric-Pressure-Profile-(Eq.-1.1,-1.3,-1.5)" title="Permalink"></a></h3><p>This component combines the hydrostatic equation with the ideal gas law to compute the complete atmospheric pressure profile.</p><p><strong>Hydrostatic equation</strong> (Eq. 1.1):</p><p class="math-container">\[\frac{dp}{dz} = -\rho \cdot g\]</p><p><strong>Combined form</strong> (Eq. 1.3):</p><p class="math-container">\[\frac{dp}{dz} = -\frac{M_{air} \cdot g \cdot p}{R \cdot T}\]</p><p><strong>Barometric formula</strong> for isothermal atmosphere (Eq. 1.5):</p><p class="math-container">\[\frac{p(z)}{p_0} = \exp\left(-\frac{z}{H}\right)\]</p><h4 id="State-Variables-3"><a class="docs-heading-anchor" href="#State-Variables-3">State Variables</a><a class="docs-heading-anchor-permalink" href="#State-Variables-3" title="Permalink"></a></h4><pre><code class="language-julia hljs">@named sys = AtmosphericPressureProfile()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>5√ó3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">H</td><td style = "text-align: left;">1.0 m</td><td style = "text-align: left;">Scale height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">T</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Temperature (assumed constant for isothermal)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">p</td><td style = "text-align: left;">1.0 m‚Åª¬π kg s‚Åª¬≤</td><td style = "text-align: left;">Atmospheric pressure at altitude z</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">rho</td><td style = "text-align: left;">1.0 m‚Åª¬≥ kg</td><td style = "text-align: left;">Air density at altitude z</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">dpdz</td><td style = "text-align: left;">1.0 m‚Åª¬≤ kg s‚Åª¬≤</td><td style = "text-align: left;">Pressure gradient (Eq. 1.1/1.3)</td></tr></tbody></table></div><h4 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h4><pre><code class="language-julia hljs">params = parameters(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [string(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>5√ó3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">z</td><td style = "text-align: left;">1.0 m</td><td style = "text-align: left;">Altitude above sea level</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">M_air</td><td style = "text-align: left;">1.0 kg mol‚Åª¬π</td><td style = "text-align: left;">Molecular weight of dry air</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">g</td><td style = "text-align: left;">1.0 m s‚Åª¬≤</td><td style = "text-align: left;">Gravitational acceleration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">p_0</td><td style = "text-align: left;">1.0 m‚Åª¬π kg s‚Åª¬≤</td><td style = "text-align: left;">Standard sea level pressure</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">R</td><td style = "text-align: left;">1.0 m¬≤ kg s‚Åª¬≤ K‚Åª¬π mol‚Åª¬π</td><td style = "text-align: left;">Universal gas constant</td></tr></tbody></table></div><h4 id="Equations-3"><a class="docs-heading-anchor" href="#Equations-3">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-3" title="Permalink"></a></h4><pre><code class="language-julia hljs">equations(sys)</code></pre><p class="math-container">\[ \begin{align}
H\left( t \right) &amp;= \frac{R T\left( t \right)}{\mathtt{M\_air} g} \\
p\left( t \right) &amp;= \mathtt{p\_0} e^{\frac{ - z}{H\left( t \right)}} \\
\mathtt{rho}\left( t \right) &amp;= \frac{\mathtt{M\_air} p\left( t \right)}{R T\left( t \right)} \\
\mathtt{dpdz}\left( t \right) &amp;=  - g \mathtt{rho}\left( t \right)
\end{align}
 \]</p><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h3 id="Total-Molar-Concentration-(Eq.-1.7)"><a class="docs-heading-anchor" href="#Total-Molar-Concentration-(Eq.-1.7)">Total Molar Concentration (Eq. 1.7)</a><a id="Total-Molar-Concentration-(Eq.-1.7)-1"></a><a class="docs-heading-anchor-permalink" href="#Total-Molar-Concentration-(Eq.-1.7)" title="Permalink"></a></h3><p class="math-container">\[c_{total} = \frac{N}{V} = \frac{p}{R \cdot T}\]</p><h4 id="State-Variables-4"><a class="docs-heading-anchor" href="#State-Variables-4">State Variables</a><a class="docs-heading-anchor-permalink" href="#State-Variables-4" title="Permalink"></a></h4><pre><code class="language-julia hljs">@named sys = TotalMolarConcentration()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>3√ó3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">c_total</td><td style = "text-align: left;">1.0 m‚Åª¬≥ mol</td><td style = "text-align: left;">Total molar concentration of air</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">p</td><td style = "text-align: left;">1.0 m‚Åª¬π kg s‚Åª¬≤</td><td style = "text-align: left;">Atmospheric pressure</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">T</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Temperature</td></tr></tbody></table></div><h4 id="Equations-4"><a class="docs-heading-anchor" href="#Equations-4">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-4" title="Permalink"></a></h4><pre><code class="language-julia hljs">equations(sys)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{c\_total}\left( t \right) &amp;= \frac{p\left( t \right)}{R T\left( t \right)}
\end{align}
 \]</p><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h3 id="Mixing-Ratio-(Eq.-1.6)"><a class="docs-heading-anchor" href="#Mixing-Ratio-(Eq.-1.6)">Mixing Ratio (Eq. 1.6)</a><a id="Mixing-Ratio-(Eq.-1.6)-1"></a><a class="docs-heading-anchor-permalink" href="#Mixing-Ratio-(Eq.-1.6)" title="Permalink"></a></h3><p class="math-container">\[\xi_i = \frac{c_i}{c_{total}}\]</p><h4 id="State-Variables-5"><a class="docs-heading-anchor" href="#State-Variables-5">State Variables</a><a class="docs-heading-anchor-permalink" href="#State-Variables-5" title="Permalink"></a></h4><pre><code class="language-julia hljs">@named sys = MixingRatio()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>3√ó3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">xi</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Volume mixing ratio (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">c_i</td><td style = "text-align: left;">1.0 m‚Åª¬≥ mol</td><td style = "text-align: left;">Molar concentration of species i</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">c_total</td><td style = "text-align: left;">1.0 m‚Åª¬≥ mol</td><td style = "text-align: left;">Total molar concentration of air</td></tr></tbody></table></div><h4 id="Equations-5"><a class="docs-heading-anchor" href="#Equations-5">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-5" title="Permalink"></a></h4><pre><code class="language-julia hljs">equations(sys)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{xi}\left( t \right) &amp;= \frac{\mathtt{c\_i}\left( t \right)}{\mathtt{c\_total}\left( t \right)}
\end{align}
 \]</p><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h3 id="Partial-Pressure-Mixing-Ratio-(Eq.-1.8)"><a class="docs-heading-anchor" href="#Partial-Pressure-Mixing-Ratio-(Eq.-1.8)">Partial Pressure Mixing Ratio (Eq. 1.8)</a><a id="Partial-Pressure-Mixing-Ratio-(Eq.-1.8)-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-Pressure-Mixing-Ratio-(Eq.-1.8)" title="Permalink"></a></h3><p class="math-container">\[\xi_i = \frac{p_i}{p}\]</p><h4 id="State-Variables-6"><a class="docs-heading-anchor" href="#State-Variables-6">State Variables</a><a class="docs-heading-anchor-permalink" href="#State-Variables-6" title="Permalink"></a></h4><pre><code class="language-julia hljs">@named sys = PartialPressureMixingRatio()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>3√ó3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">xi</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Volume mixing ratio (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">p_i</td><td style = "text-align: left;">1.0 m‚Åª¬π kg s‚Åª¬≤</td><td style = "text-align: left;">Partial pressure of species i</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">p</td><td style = "text-align: left;">1.0 m‚Åª¬π kg s‚Åª¬≤</td><td style = "text-align: left;">Total atmospheric pressure</td></tr></tbody></table></div><h4 id="Equations-6"><a class="docs-heading-anchor" href="#Equations-6">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-6" title="Permalink"></a></h4><pre><code class="language-julia hljs">equations(sys)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{xi}\left( t \right) &amp;= \frac{\mathtt{p\_i}\left( t \right)}{p\left( t \right)}
\end{align}
 \]</p><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h3 id="Saturation-Vapor-Pressure-(Eq.-1.10)"><a class="docs-heading-anchor" href="#Saturation-Vapor-Pressure-(Eq.-1.10)">Saturation Vapor Pressure (Eq. 1.10)</a><a id="Saturation-Vapor-Pressure-(Eq.-1.10)-1"></a><a class="docs-heading-anchor-permalink" href="#Saturation-Vapor-Pressure-(Eq.-1.10)" title="Permalink"></a></h3><p class="math-container">\[p_{H_2O,sat}(T) = p_{std} \cdot \exp(13.3185a - 1.9760a^2 - 0.6445a^3 - 0.1299a^4)\]</p><p>where <span>$a = 1 - 373.15/T$</span>.</p><h4 id="State-Variables-7"><a class="docs-heading-anchor" href="#State-Variables-7">State Variables</a><a class="docs-heading-anchor-permalink" href="#State-Variables-7" title="Permalink"></a></h4><pre><code class="language-julia hljs">@named sys = SaturationVaporPressure()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>3√ó3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">a</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Dimensionless temperature parameter (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">T</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">p_sat</td><td style = "text-align: left;">1.0 m‚Åª¬π kg s‚Åª¬≤</td><td style = "text-align: left;">Saturation vapor pressure of water</td></tr></tbody></table></div><h4 id="Equations-7"><a class="docs-heading-anchor" href="#Equations-7">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-7" title="Permalink"></a></h4><pre><code class="language-julia hljs">equations(sys)</code></pre><p class="math-container">\[ \begin{align}
a\left( t \right) &amp;= 1 + \frac{ - \mathtt{T\_boil}}{T\left( t \right)} \\
\mathtt{p\_sat}\left( t \right) &amp;= \mathtt{p\_std} e^{\mathtt{c1} a\left( t \right) - \left( a\left( t \right) \right)^{2} \mathtt{c2} - \left( a\left( t \right) \right)^{3} \mathtt{c3} - \left( a\left( t \right) \right)^{4} \mathtt{c4}}
\end{align}
 \]</p><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h3 id="Relative-Humidity-(Eq.-1.9)"><a class="docs-heading-anchor" href="#Relative-Humidity-(Eq.-1.9)">Relative Humidity (Eq. 1.9)</a><a id="Relative-Humidity-(Eq.-1.9)-1"></a><a class="docs-heading-anchor-permalink" href="#Relative-Humidity-(Eq.-1.9)" title="Permalink"></a></h3><p class="math-container">\[RH = 100 \cdot \frac{p_{H_2O}}{p_{H_2O,sat}}\]</p><h4 id="State-Variables-8"><a class="docs-heading-anchor" href="#State-Variables-8">State Variables</a><a class="docs-heading-anchor-permalink" href="#State-Variables-8" title="Permalink"></a></h4><pre><code class="language-julia hljs">@named sys = RelativeHumidity()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>3√ó3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">RH</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Relative humidity (0-100, dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">p_H2O</td><td style = "text-align: left;">1.0 m‚Åª¬π kg s‚Åª¬≤</td><td style = "text-align: left;">Partial pressure of water vapor</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">p_sat</td><td style = "text-align: left;">1.0 m‚Åª¬π kg s‚Åª¬≤</td><td style = "text-align: left;">Saturation vapor pressure of water</td></tr></tbody></table></div><h4 id="Equations-8"><a class="docs-heading-anchor" href="#Equations-8">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-8" title="Permalink"></a></h4><pre><code class="language-julia hljs">equations(sys)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{RH}\left( t \right) &amp;= \frac{\mathtt{percent\_factor} \mathtt{p\_H2O}\left( t \right)}{\mathtt{p\_sat}\left( t \right)}
\end{align}
 \]</p><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h3 id="Composite:-Atmospheric-Thermodynamics"><a class="docs-heading-anchor" href="#Composite:-Atmospheric-Thermodynamics">Composite: Atmospheric Thermodynamics</a><a id="Composite:-Atmospheric-Thermodynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Composite:-Atmospheric-Thermodynamics" title="Permalink"></a></h3><p>Combines Equations 1.2, 1.4, 1.5, and 1.7 for complete atmospheric thermodynamic properties at a given altitude and temperature.</p><h4 id="State-Variables-9"><a class="docs-heading-anchor" href="#State-Variables-9">State Variables</a><a class="docs-heading-anchor-permalink" href="#State-Variables-9" title="Permalink"></a></h4><pre><code class="language-julia hljs">@named sys = AtmosphericThermodynamics()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>5√ó3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">H</td><td style = "text-align: left;">1.0 m</td><td style = "text-align: left;">Scale height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">T</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">p</td><td style = "text-align: left;">1.0 m‚Åª¬π kg s‚Åª¬≤</td><td style = "text-align: left;">Atmospheric pressure at altitude z</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">rho</td><td style = "text-align: left;">1.0 m‚Åª¬≥ kg</td><td style = "text-align: left;">Air density at altitude z</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">c_total</td><td style = "text-align: left;">1.0 m‚Åª¬≥ mol</td><td style = "text-align: left;">Total molar concentration</td></tr></tbody></table></div><h4 id="Parameters-2"><a class="docs-heading-anchor" href="#Parameters-2">Parameters</a><a class="docs-heading-anchor-permalink" href="#Parameters-2" title="Permalink"></a></h4><pre><code class="language-julia hljs">params = parameters(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [string(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>5√ó3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">z</td><td style = "text-align: left;">1.0 m</td><td style = "text-align: left;">Altitude above sea level</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">M_air</td><td style = "text-align: left;">1.0 kg mol‚Åª¬π</td><td style = "text-align: left;">Molecular weight of dry air</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">g</td><td style = "text-align: left;">1.0 m s‚Åª¬≤</td><td style = "text-align: left;">Gravitational acceleration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">p_0</td><td style = "text-align: left;">1.0 m‚Åª¬π kg s‚Åª¬≤</td><td style = "text-align: left;">Standard sea level pressure</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">R</td><td style = "text-align: left;">1.0 m¬≤ kg s‚Åª¬≤ K‚Åª¬π mol‚Åª¬π</td><td style = "text-align: left;">Universal gas constant</td></tr></tbody></table></div><h4 id="Equations-9"><a class="docs-heading-anchor" href="#Equations-9">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-9" title="Permalink"></a></h4><pre><code class="language-julia hljs">equations(sys)</code></pre><p class="math-container">\[ \begin{align}
H\left( t \right) &amp;= \frac{R T\left( t \right)}{\mathtt{M\_air} g} \\
p\left( t \right) &amp;= \mathtt{p\_0} e^{\frac{ - z}{H\left( t \right)}} \\
\mathtt{rho}\left( t \right) &amp;= \frac{\mathtt{M\_air} p\left( t \right)}{R T\left( t \right)} \\
\mathtt{c\_total}\left( t \right) &amp;= \frac{p\left( t \right)}{R T\left( t \right)}
\end{align}
 \]</p><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h3 id="Composite:-Water-Vapor-Thermodynamics"><a class="docs-heading-anchor" href="#Composite:-Water-Vapor-Thermodynamics">Composite: Water Vapor Thermodynamics</a><a id="Composite:-Water-Vapor-Thermodynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Composite:-Water-Vapor-Thermodynamics" title="Permalink"></a></h3><p>Combines the saturation vapor pressure (Eq. 1.10) and relative humidity (Eq. 1.9) systems.</p><h4 id="State-Variables-10"><a class="docs-heading-anchor" href="#State-Variables-10">State Variables</a><a class="docs-heading-anchor-permalink" href="#State-Variables-10" title="Permalink"></a></h4><pre><code class="language-julia hljs">@named sys = WaterVaporThermodynamics()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>10√ó3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">sat‚ÇäT</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">T</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">rh‚Çäp_sat</td><td style = "text-align: left;">1.0 m‚Åª¬π kg s‚Åª¬≤</td><td style = "text-align: left;">Saturation vapor pressure of water</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">sat‚Çäp_sat</td><td style = "text-align: left;">1.0 m‚Åª¬π kg s‚Åª¬≤</td><td style = "text-align: left;">Saturation vapor pressure of water</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">rh‚Çäp_H2O</td><td style = "text-align: left;">1.0 m‚Åª¬π kg s‚Åª¬≤</td><td style = "text-align: left;">Partial pressure of water vapor</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">p_H2O</td><td style = "text-align: left;">1.0 m‚Åª¬π kg s‚Åª¬≤</td><td style = "text-align: left;">Partial pressure of water vapor</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">p_sat</td><td style = "text-align: left;">1.0 m‚Åª¬π kg s‚Åª¬≤</td><td style = "text-align: left;">Saturation vapor pressure</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">RH</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Relative humidity (0-100, dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">rh‚ÇäRH</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Relative humidity (0-100, dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">sat‚Çäa</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Dimensionless temperature parameter (dimensionless)</td></tr></tbody></table></div><h4 id="Equations-10"><a class="docs-heading-anchor" href="#Equations-10">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-10" title="Permalink"></a></h4><pre><code class="language-julia hljs">equations(sys)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{sat.T}\left( t \right) &amp;= T\left( t \right) \\
\mathtt{rh.p\_sat}\left( t \right) &amp;= \mathtt{sat.p\_sat}\left( t \right) \\
\mathtt{rh.p\_H2O}\left( t \right) &amp;= \mathtt{p\_H2O}\left( t \right) \\
\mathtt{p\_sat}\left( t \right) &amp;= \mathtt{sat.p\_sat}\left( t \right) \\
\mathtt{RH}\left( t \right) &amp;= \mathtt{rh.RH}\left( t \right) \\
\mathtt{sat.a}\left( t \right) &amp;= 1 + \frac{ - \mathtt{sat.T\_boil}}{\mathtt{sat.T}\left( t \right)} \\
\mathtt{sat.p\_sat}\left( t \right) &amp;= \mathtt{sat.p\_std} e^{\mathtt{sat.c1} \mathtt{sat.a}\left( t \right) - \left( \mathtt{sat.a}\left( t \right) \right)^{2} \mathtt{sat.c2} - \left( \mathtt{sat.a}\left( t \right) \right)^{3} \mathtt{sat.c3} - \left( \mathtt{sat.a}\left( t \right) \right)^{4} \mathtt{sat.c4}} \\
\mathtt{rh.RH}\left( t \right) &amp;= \frac{\mathtt{rh.percent\_factor} \mathtt{rh.p\_H2O}\left( t \right)}{\mathtt{rh.p\_sat}\left( t \right)}
\end{align}
 \]</p><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h2 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h2><p>This section validates the implementation by reproducing key results from Seinfeld and Pandis (2006) Chapter 1.</p><h3 id="U.S.-Standard-Atmosphere-Validation-(Table-1.4)"><a class="docs-heading-anchor" href="#U.S.-Standard-Atmosphere-Validation-(Table-1.4)">U.S. Standard Atmosphere Validation (Table 1.4)</a><a id="U.S.-Standard-Atmosphere-Validation-(Table-1.4)-1"></a><a class="docs-heading-anchor-permalink" href="#U.S.-Standard-Atmosphere-Validation-(Table-1.4)" title="Permalink"></a></h3><p>Table 1.4 in the textbook provides properties of the U.S. Standard Atmosphere at various altitudes. We validate the barometric formula and ideal gas law by comparing calculated values with the reference data.</p><pre><code class="language-julia hljs">using Plots

# Physical constants (same values used in the implementation)
R_val = 8.314          # J/(mol*K)
M_air_val = 0.02897    # kg/mol
g_val = 9.807          # m/s^2
p_0_val = 101325.0     # Pa

# U.S. Standard Atmosphere data (Table 1.4)
us_std_atm = DataFrame(
    :Altitude_km =&gt; [0, 5, 10, 15, 20, 25, 30, 40, 50],
    :Temperature_K =&gt; [288.2, 255.7, 223.3, 216.7, 216.7, 221.6, 226.5, 250.4, 270.7],
    :Pressure_mbar =&gt; [1013.0, 540.5, 265.0, 121.1, 55.29, 25.49, 11.97, 2.871, 0.798],
    :Density_kg_m3 =&gt; [
        1.225, 0.736, 0.414, 0.195, 0.0889, 0.0401, 0.0184, 0.00400, 0.00103]
)
us_std_atm</code></pre><div><div style = "float: left;"><span>9√ó4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Altitude_km</th><th style = "text-align: left;">Temperature_K</th><th style = "text-align: left;">Pressure_mbar</th><th style = "text-align: left;">Density_kg_m3</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">0</td><td style = "text-align: right;">288.2</td><td style = "text-align: right;">1013.0</td><td style = "text-align: right;">1.225</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">5</td><td style = "text-align: right;">255.7</td><td style = "text-align: right;">540.5</td><td style = "text-align: right;">0.736</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">10</td><td style = "text-align: right;">223.3</td><td style = "text-align: right;">265.0</td><td style = "text-align: right;">0.414</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">15</td><td style = "text-align: right;">216.7</td><td style = "text-align: right;">121.1</td><td style = "text-align: right;">0.195</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">20</td><td style = "text-align: right;">216.7</td><td style = "text-align: right;">55.29</td><td style = "text-align: right;">0.0889</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: right;">25</td><td style = "text-align: right;">221.6</td><td style = "text-align: right;">25.49</td><td style = "text-align: right;">0.0401</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: right;">30</td><td style = "text-align: right;">226.5</td><td style = "text-align: right;">11.97</td><td style = "text-align: right;">0.0184</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: right;">40</td><td style = "text-align: right;">250.4</td><td style = "text-align: right;">2.871</td><td style = "text-align: right;">0.004</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: right;">50</td><td style = "text-align: right;">270.7</td><td style = "text-align: right;">0.798</td><td style = "text-align: right;">0.00103</td></tr></tbody></table></div><h3 id="Pressure-Profile-Comparison"><a class="docs-heading-anchor" href="#Pressure-Profile-Comparison">Pressure Profile Comparison</a><a id="Pressure-Profile-Comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Pressure-Profile-Comparison" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Calculate pressure using barometric formula with local scale height
function calc_pressure_variable_H(z_km, T_K)
    z = z_km * 1000.0
    H = R_val * T_K / (M_air_val * g_val)
    return p_0_val * exp(-z / H) / 100  # Convert to mbar
end

calculated_p = [calc_pressure_variable_H(z, T)
                for (z, T) in
                    zip(us_std_atm.Altitude_km, us_std_atm.Temperature_K)]

comparison = DataFrame(
    :Altitude_km =&gt; us_std_atm.Altitude_km,
    :Ref_Pressure_mbar =&gt; us_std_atm.Pressure_mbar,
    :Calc_Pressure_mbar =&gt; round.(calculated_p, digits = 2),
    :Error_percent =&gt; round.(
        100 .* (calculated_p .- us_std_atm.Pressure_mbar) ./ us_std_atm.Pressure_mbar,
        digits = 1
    )
)
comparison</code></pre><div><div style = "float: left;"><span>9√ó4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Altitude_km</th><th style = "text-align: left;">Ref_Pressure_mbar</th><th style = "text-align: left;">Calc_Pressure_mbar</th><th style = "text-align: left;">Error_percent</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">0</td><td style = "text-align: right;">1013.0</td><td style = "text-align: right;">1013.25</td><td style = "text-align: right;">0.0</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">5</td><td style = "text-align: right;">540.5</td><td style = "text-align: right;">519.42</td><td style = "text-align: right;">-3.9</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">10</td><td style = "text-align: right;">265.0</td><td style = "text-align: right;">219.33</td><td style = "text-align: right;">-17.2</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">15</td><td style = "text-align: right;">121.1</td><td style = "text-align: right;">95.15</td><td style = "text-align: right;">-21.4</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">20</td><td style = "text-align: right;">55.29</td><td style = "text-align: right;">43.25</td><td style = "text-align: right;">-21.8</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: right;">25</td><td style = "text-align: right;">25.49</td><td style = "text-align: right;">21.45</td><td style = "text-align: right;">-15.8</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: right;">30</td><td style = "text-align: right;">11.97</td><td style = "text-align: right;">10.97</td><td style = "text-align: right;">-8.4</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: right;">40</td><td style = "text-align: right;">2.871</td><td style = "text-align: right;">4.31</td><td style = "text-align: right;">50.3</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: right;">50</td><td style = "text-align: right;">0.798</td><td style = "text-align: right;">1.84</td><td style = "text-align: right;">130.4</td></tr></tbody></table></div><h3 id="Density-Profile-Comparison"><a class="docs-heading-anchor" href="#Density-Profile-Comparison">Density Profile Comparison</a><a id="Density-Profile-Comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Density-Profile-Comparison" title="Permalink"></a></h3><pre><code class="language-julia hljs">function calc_density(p_mbar, T_K)
    p_Pa = p_mbar * 100
    return M_air_val * p_Pa / (R_val * T_K)
end

calculated_rho = [calc_density(p, T)
                  for (p, T) in
                      zip(us_std_atm.Pressure_mbar, us_std_atm.Temperature_K)]

density_comparison = DataFrame(
    :Altitude_km =&gt; us_std_atm.Altitude_km,
    :Ref_Density_kg_m3 =&gt; us_std_atm.Density_kg_m3,
    :Calc_Density_kg_m3 =&gt; round.(calculated_rho, digits = 4),
    :Error_percent =&gt; round.(
        100 .* (calculated_rho .- us_std_atm.Density_kg_m3) ./ us_std_atm.Density_kg_m3,
        digits = 1
    )
)
density_comparison</code></pre><div><div style = "float: left;"><span>9√ó4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Altitude_km</th><th style = "text-align: left;">Ref_Density_kg_m3</th><th style = "text-align: left;">Calc_Density_kg_m3</th><th style = "text-align: left;">Error_percent</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">0</td><td style = "text-align: right;">1.225</td><td style = "text-align: right;">1.2248</td><td style = "text-align: right;">-0.0</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">5</td><td style = "text-align: right;">0.736</td><td style = "text-align: right;">0.7366</td><td style = "text-align: right;">0.1</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">10</td><td style = "text-align: right;">0.414</td><td style = "text-align: right;">0.4135</td><td style = "text-align: right;">-0.1</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">15</td><td style = "text-align: right;">0.195</td><td style = "text-align: right;">0.1947</td><td style = "text-align: right;">-0.1</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">20</td><td style = "text-align: right;">0.0889</td><td style = "text-align: right;">0.0889</td><td style = "text-align: right;">0.0</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: right;">25</td><td style = "text-align: right;">0.0401</td><td style = "text-align: right;">0.0401</td><td style = "text-align: right;">-0.0</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: right;">30</td><td style = "text-align: right;">0.0184</td><td style = "text-align: right;">0.0184</td><td style = "text-align: right;">0.1</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: right;">40</td><td style = "text-align: right;">0.004</td><td style = "text-align: right;">0.004</td><td style = "text-align: right;">-0.1</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: right;">50</td><td style = "text-align: right;">0.00103</td><td style = "text-align: right;">0.001</td><td style = "text-align: right;">-0.3</td></tr></tbody></table></div><p>The density calculation matches Table 1.4 values within 1%, validating the ideal gas law implementation (Eq. 1.2).</p><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h3 id="Pressure-Altitude-Profile-(Figure)"><a class="docs-heading-anchor" href="#Pressure-Altitude-Profile-(Figure)">Pressure-Altitude Profile (Figure)</a><a id="Pressure-Altitude-Profile-(Figure)-1"></a><a class="docs-heading-anchor-permalink" href="#Pressure-Altitude-Profile-(Figure)" title="Permalink"></a></h3><p>This figure shows the exponential decrease of atmospheric pressure with altitude, comparing the isothermal barometric formula with U.S. Standard Atmosphere data.</p><pre><code class="language-julia hljs">z_range = 0:0.5:50  # km

# Isothermal atmosphere at T = 253 K (H = 7.4 km)
H_253 = R_val * 253 / (M_air_val * g_val)
p_253 = [p_0_val * exp(-z * 1000 / H_253) / 100 for z in z_range]

# Isothermal atmosphere at T = 288 K (H = 8.4 km)
H_288 = R_val * 288 / (M_air_val * g_val)
p_288 = [p_0_val * exp(-z * 1000 / H_288) / 100 for z in z_range]

p1 = plot(;
    xlabel = &quot;Altitude (km)&quot;,
    ylabel = &quot;Pressure (mbar)&quot;,
    title = &quot;Atmospheric Pressure vs Altitude&quot;,
    legend = :topright,
    yscale = :log10,
    ylims = (0.1, 2000),
    size = (700, 500),
    grid = true
)

plot!(p1, z_range, p_253;
    label = &quot;Isothermal T = 253 K (H = 7.4 km)&quot;,
    linewidth = 2,
    color = :blue,
    linestyle = :dash)

plot!(p1, z_range, p_288;
    label = &quot;Isothermal T = 288 K (H = 8.4 km)&quot;,
    linewidth = 2,
    color = :red,
    linestyle = :dash)

scatter!(p1, us_std_atm.Altitude_km, us_std_atm.Pressure_mbar;
    label = &quot;U.S. Standard Atmosphere&quot;,
    markersize = 8,
    color = :black)

p1</code></pre><img src="0912b48d.svg" alt="Example block output"/><p>The U.S. Standard Atmosphere data falls between the two isothermal curves because the real atmosphere has a temperature profile that varies with altitude.</p><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h3 id="Scale-Height-Variation-(Figure)"><a class="docs-heading-anchor" href="#Scale-Height-Variation-(Figure)">Scale Height Variation (Figure)</a><a id="Scale-Height-Variation-(Figure)-1"></a><a class="docs-heading-anchor-permalink" href="#Scale-Height-Variation-(Figure)" title="Permalink"></a></h3><p>The scale height depends on temperature and determines how quickly pressure decreases with altitude.</p><pre><code class="language-julia hljs">T_range = 200:5:320
H_values = [R_val * T / (M_air_val * g_val) / 1000 for T in T_range]  # km

p2 = plot(
    T_range, H_values;
    xlabel = &quot;Temperature (K)&quot;,
    ylabel = &quot;Scale Height (km)&quot;,
    title = &quot;Atmospheric Scale Height vs Temperature (Eq. 1.4)&quot;,
    legend = false,
    linewidth = 2,
    color = :blue,
    size = (600, 400),
    grid = true
)

scatter!(p2, [253, 288, 216.7],
    [R_val * 253 / (M_air_val * g_val) / 1000,
        R_val * 288 / (M_air_val * g_val) / 1000,
        R_val * 216.7 / (M_air_val * g_val) / 1000];
    markersize = 10,
    color = :red,
    label = nothing)

annotate!(p2, 253, 7.0, text(&quot;Troposphere\n(253 K)&quot;, 8, :center))
annotate!(p2, 288, 9.0, text(&quot;Sea level\n(288 K)&quot;, 8, :center))
annotate!(p2, 216.7, 8.0, text(&quot;Tropopause\n(217 K)&quot;, 8, :center))

p2</code></pre><img src="ea073913.svg" alt="Example block output"/><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h3 id="Saturation-Vapor-Pressure-of-Water-(Figure)"><a class="docs-heading-anchor" href="#Saturation-Vapor-Pressure-of-Water-(Figure)">Saturation Vapor Pressure of Water (Figure)</a><a id="Saturation-Vapor-Pressure-of-Water-(Figure)-1"></a><a class="docs-heading-anchor-permalink" href="#Saturation-Vapor-Pressure-of-Water-(Figure)" title="Permalink"></a></h3><p>This figure reproduces the saturation vapor pressure curve from Equation 1.10.</p><pre><code class="language-julia hljs">T_boil_val = 373.15
p_std_val = 101325.0  # Pa

T_sat_range = 273:1:373

function calc_p_sat(T)
    a = 1 - T_boil_val / T
    return p_std_val * exp(13.3185 * a - 1.9760 * a^2 - 0.6445 * a^3 - 0.1299 * a^4)
end

p_sat_values = [calc_p_sat(T) for T in T_sat_range]

# Reference values
T_ref = [273.15, 283.15, 293.15, 298.15, 303.15, 313.15, 323.15, 373.15]
p_sat_ref = [611, 1228, 2338, 3168, 4245, 7378, 12349, 101325]  # Pa

p3 = plot(
    T_sat_range, p_sat_values ./ 1000;
    xlabel = &quot;Temperature (K)&quot;,
    ylabel = &quot;Saturation Vapor Pressure (kPa)&quot;,
    title = &quot;Saturation Vapor Pressure of Water (Eq. 1.10)&quot;,
    legend = :topleft,
    linewidth = 2,
    color = :blue,
    label = &quot;Eq. 1.10&quot;,
    size = (600, 400),
    grid = true
)

scatter!(p3, T_ref, p_sat_ref ./ 1000;
    markersize = 8,
    color = :red,
    label = &quot;Reference values&quot;)

p3</code></pre><img src="475f961f.svg" alt="Example block output"/><h3 id="Saturation-Vapor-Pressure-Table"><a class="docs-heading-anchor" href="#Saturation-Vapor-Pressure-Table">Saturation Vapor Pressure Table</a><a id="Saturation-Vapor-Pressure-Table-1"></a><a class="docs-heading-anchor-permalink" href="#Saturation-Vapor-Pressure-Table" title="Permalink"></a></h3><pre><code class="language-julia hljs">T_table = [273.15, 278.15, 283.15, 288.15, 293.15, 298.15, 303.15, 308.15, 313.15, 373.15]
p_sat_calc = [calc_p_sat(T) for T in T_table]

DataFrame(
    :T_Celsius =&gt; round.(T_table .- 273.15, digits = 1),
    :T_Kelvin =&gt; round.(T_table, digits = 2),
    :p_sat_Pa =&gt; round.(p_sat_calc, digits = 1),
    :p_sat_mbar =&gt; round.(p_sat_calc ./ 100, digits = 2)
)</code></pre><div><div style = "float: left;"><span>10√ó4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">T_Celsius</th><th style = "text-align: left;">T_Kelvin</th><th style = "text-align: left;">p_sat_Pa</th><th style = "text-align: left;">p_sat_mbar</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">273.15</td><td style = "text-align: right;">610.7</td><td style = "text-align: right;">6.11</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">5.0</td><td style = "text-align: right;">278.15</td><td style = "text-align: right;">871.9</td><td style = "text-align: right;">8.72</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">10.0</td><td style = "text-align: right;">283.15</td><td style = "text-align: right;">1227.2</td><td style = "text-align: right;">12.27</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">15.0</td><td style = "text-align: right;">288.15</td><td style = "text-align: right;">1704.4</td><td style = "text-align: right;">17.04</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">20.0</td><td style = "text-align: right;">293.15</td><td style = "text-align: right;">2337.2</td><td style = "text-align: right;">23.37</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: right;">25.0</td><td style = "text-align: right;">298.15</td><td style = "text-align: right;">3166.9</td><td style = "text-align: right;">31.67</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: right;">30.0</td><td style = "text-align: right;">303.15</td><td style = "text-align: right;">4242.6</td><td style = "text-align: right;">42.43</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: right;">35.0</td><td style = "text-align: right;">308.15</td><td style = "text-align: right;">5622.9</td><td style = "text-align: right;">56.23</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: right;">40.0</td><td style = "text-align: right;">313.15</td><td style = "text-align: right;">7376.6</td><td style = "text-align: right;">73.77</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: right;">100.0</td><td style = "text-align: right;">373.15</td><td style = "text-align: right;">101325.0</td><td style = "text-align: right;">1013.25</td></tr></tbody></table></div><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h3 id="Total-Molar-Concentration-(Figure)"><a class="docs-heading-anchor" href="#Total-Molar-Concentration-(Figure)">Total Molar Concentration (Figure)</a><a id="Total-Molar-Concentration-(Figure)-1"></a><a class="docs-heading-anchor-permalink" href="#Total-Molar-Concentration-(Figure)" title="Permalink"></a></h3><p>The total molar concentration depends on pressure and temperature through the ideal gas law (Eq. 1.7).</p><pre><code class="language-julia hljs">T_conc_range = 250:5:320
c_total_values = [p_0_val / (R_val * T) for T in T_conc_range]

p4 = plot(
    T_conc_range, c_total_values;
    xlabel = &quot;Temperature (K)&quot;,
    ylabel = &quot;Total Molar Concentration (mol/m^3)&quot;,
    title = &quot;Total Molar Concentration at p = 101325 Pa (Eq. 1.7)&quot;,
    legend = false,
    linewidth = 2,
    color = :blue,
    size = (600, 400),
    grid = true
)

scatter!(p4, [273.15, 298.15],
    [p_0_val / (R_val * 273.15), p_0_val / (R_val * 298.15)];
    markersize = 10,
    color = :red)

annotate!(p4, 273.15, 46.5, text(&quot;STP\n(44.6 mol/m^3)&quot;, 8, :center))
annotate!(p4, 298.15, 39.0, text(&quot;Room temp\n(40.9 mol/m^3)&quot;, 8, :center))

p4</code></pre><img src="956e63f2.svg" alt="Example block output"/><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h3 id="Atmospheric-Profile-Summary-(Figure)"><a class="docs-heading-anchor" href="#Atmospheric-Profile-Summary-(Figure)">Atmospheric Profile Summary (Figure)</a><a id="Atmospheric-Profile-Summary-(Figure)-1"></a><a class="docs-heading-anchor-permalink" href="#Atmospheric-Profile-Summary-(Figure)" title="Permalink"></a></h3><p>This figure summarizes the vertical structure of the atmosphere using data from Table 1.4.</p><pre><code class="language-julia hljs">altitudes = [0, 5, 10, 15, 20, 25, 30, 40, 50]
temperatures = [288.2, 255.7, 223.3, 216.7, 216.7, 221.6, 226.5, 250.4, 270.7]
pressures = [1013.0, 540.5, 265.0, 121.1, 55.29, 25.49, 11.97, 2.871, 0.798]
densities = [1.225, 0.736, 0.414, 0.195, 0.0889, 0.0401, 0.0184, 0.00400, 0.00103]

l = @layout [a b c]

p_temp = plot(temperatures, altitudes;
    xlabel = &quot;Temperature (K)&quot;,
    ylabel = &quot;Altitude (km)&quot;,
    title = &quot;Temperature&quot;,
    linewidth = 2,
    marker = :circle,
    color = :red,
    legend = false,
    xlims = (200, 300))

hline!(p_temp, [11]; color = :gray, linestyle = :dash, label = nothing)
annotate!(p_temp, 250, 5, text(&quot;Troposphere&quot;, 8, :center))
annotate!(p_temp, 250, 25, text(&quot;Stratosphere&quot;, 8, :center))

p_press = plot(pressures, altitudes;
    xlabel = &quot;Pressure (mbar)&quot;,
    ylabel = &quot;Altitude (km)&quot;,
    title = &quot;Pressure&quot;,
    linewidth = 2,
    marker = :circle,
    color = :blue,
    xscale = :log10,
    legend = false)

p_dens = plot(densities, altitudes;
    xlabel = &quot;Density (kg/m^3)&quot;,
    ylabel = &quot;Altitude (km)&quot;,
    title = &quot;Density&quot;,
    linewidth = 2,
    marker = :circle,
    color = :green,
    xscale = :log10,
    legend = false)

plot(p_temp, p_press, p_dens;
    layout = l,
    size = (900, 400),
    plot_title = &quot;U.S. Standard Atmosphere (Table 1.4)&quot;)</code></pre><img src="3cd3f97a.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../puff/">¬´ Puff Model</a><a class="docs-footer-nextpage" href="../local_scale_meteorology/">Local Scale Meteorology ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 4 February 2026 08:36">Wednesday 4 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
