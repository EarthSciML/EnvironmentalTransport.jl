<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Local Scale Meteorology ¬∑ EnvironmentalTransport.jl</title><meta name="title" content="Local Scale Meteorology ¬∑ EnvironmentalTransport.jl"/><meta property="og:title" content="Local Scale Meteorology ¬∑ EnvironmentalTransport.jl"/><meta property="twitter:title" content="Local Scale Meteorology ¬∑ EnvironmentalTransport.jl"/><meta name="description" content="Documentation for EnvironmentalTransport.jl."/><meta property="og:description" content="Documentation for EnvironmentalTransport.jl."/><meta property="twitter:description" content="Documentation for EnvironmentalTransport.jl."/><meta property="og:url" content="https://EarthSciML.github.io/EnvironmentalTransport.jl/local_scale_meteorology/"/><meta property="twitter:url" content="https://EarthSciML.github.io/EnvironmentalTransport.jl/local_scale_meteorology/"/><link rel="canonical" href="https://EarthSciML.github.io/EnvironmentalTransport.jl/local_scale_meteorology/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">EnvironmentalTransport.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../advection/">Advection</a></li><li><a class="tocitem" href="../puff/">Puff Model</a></li><li><a class="tocitem" href="../seinfeld_pandis_ch1/">Atmospheric Fundamentals</a></li><li class="is-active"><a class="tocitem" href>Local Scale Meteorology</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li><li><a class="tocitem" href="#Roughness-Length-Reference-(Table-16.1)"><span>Roughness Length Reference (Table 16.1)</span></a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../benchmarks/">üîó Benchmarks</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Local Scale Meteorology</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Local Scale Meteorology</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EarthSciML/EnvironmentalTransport.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/main/docs/src/local_scale_meteorology.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Local-Scale-Meteorology"><a class="docs-heading-anchor" href="#Local-Scale-Meteorology">Local Scale Meteorology</a><a id="Local-Scale-Meteorology-1"></a><a class="docs-heading-anchor-permalink" href="#Local-Scale-Meteorology" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>This module implements equations for local-scale atmospheric boundary layer meteorology, including:</p><ul><li>Atmospheric stability classification based on potential temperature</li><li>Monin-Obukhov similarity theory for the surface layer</li><li>Logarithmic wind profiles with stability corrections</li><li>Pasquill stability class estimation</li></ul><p>These equations are essential for understanding pollutant dispersion in the atmospheric boundary layer, where turbulent mixing is driven by mechanical (wind shear) and thermal (buoyancy) effects.</p><p><strong>Reference</strong>: Seinfeld, J.H. and Pandis, S.N. (2006) <em>Atmospheric Chemistry and Physics: From Air Pollution to Climate Change</em>, 2nd Edition, Chapter 16: &quot;Meteorology of the Local Scale&quot;, pp. 720-760. John Wiley &amp; Sons.</p><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.LocalScaleMeteorology"><a class="docstring-binding" href="#EnvironmentalTransport.LocalScaleMeteorology"><code>EnvironmentalTransport.LocalScaleMeteorology</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">LocalScaleMeteorology(; name=:LocalScaleMeteorology)</code></pre><p>Returns a <code>ModelingToolkit.System</code> combining atmospheric stability analysis with surface layer Monin-Obukhov similarity theory for comprehensive local-scale meteorological calculations.</p><p>Based on Chapter 16 &quot;Meteorology of the Local Scale&quot; from Seinfeld &amp; Pandis (2006) &quot;Atmospheric Chemistry and Physics&quot;, 2nd Edition, pp. 720-760.</p><p>This composite system includes:</p><ul><li>Potential temperature and stability classification</li><li>Dry adiabatic lapse rate</li><li>Monin-Obukhov length and stability parameter</li><li>Stability-corrected wind profiles</li><li>Pasquill stability class estimation (Table 16.4)</li></ul><p>Key equations:</p><ul><li>Eq. 16.8: Œì = g/ƒâ_p ‚âà 9.76 K/km (dry adiabatic lapse rate)</li><li>Eq. 16.14: Œ∏ = T(p‚ÇÄ/p)^0.286 (potential temperature)</li><li>Eq. 16.66: ≈´ = (u*/Œ∫)ln(z/z‚ÇÄ) (log wind profile)</li><li>Eq. 16.70: L = -œÅƒâ<em>p T‚ÇÄ u*¬≥/(Œ∫g qÃÑ</em>z) (Monin-Obukhov length)</li><li>Eq. 16.75: œÜ<em>m, œÜ</em>h (Businger-Dyer stability functions)</li><li>Eq. 16.83: 1/L = a + b¬∑log‚ÇÅ‚ÇÄ(z‚ÇÄ) (Golder correlation for Pasquill classes)</li></ul><p>Pasquill Stability Classes (Table 16.4):</p><ul><li>A: Very unstable (strong convection)</li><li>B: Moderately unstable</li><li>C: Slightly unstable</li><li>D: Neutral</li><li>E: Slightly stable</li><li>F: Moderately stable</li><li>G: Very stable (strong inversion)</li></ul><p>Example:</p><pre><code class="language-julia hljs">using ModelingToolkit, EnvironmentalTransport

met = LocalScaleMeteorology()
sys = mtkcompile(met)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/local_scale_meteorology.jl#L184-L225">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.AtmosphericStability"><a class="docstring-binding" href="#EnvironmentalTransport.AtmosphericStability"><code>EnvironmentalTransport.AtmosphericStability</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">AtmosphericStability(; name=:AtmosphericStability)</code></pre><p>Returns a <code>ModelingToolkit.System</code> that computes atmospheric stability parameters including potential temperature, dry adiabatic lapse rate, and stability classification.</p><p>Based on Chapter 16 &quot;Meteorology of the Local Scale&quot; from Seinfeld &amp; Pandis (2006) &quot;Atmospheric Chemistry and Physics&quot;, 2nd Edition, pp. 720-760.</p><p>Key equations implemented:</p><ul><li>Eq. 16.8: Dry adiabatic lapse rate Œì = g/ƒâ_p ‚âà 9.76 K/km</li><li>Eq. 16.14: Potential temperature Œ∏ = T(p‚ÇÄ/p)^(R/ƒâ_p)</li><li>Eq. 16.16-16.18: Stability classification based on ‚àÇŒ∏/‚àÇz</li></ul><p>The stability parameter S indicates:</p><ul><li>S &gt; 0: Stable atmosphere (‚àÇŒ∏/‚àÇz &gt; 0)</li><li>S = 0: Neutral atmosphere (‚àÇŒ∏/‚àÇz = 0)</li><li>S &lt; 0: Unstable atmosphere (‚àÇŒ∏/‚àÇz &lt; 0)</li></ul><p>Example:</p><pre><code class="language-julia hljs">using ModelingToolkit, EnvironmentalTransport

stab = AtmosphericStability()
sys = mtkcompile(stab)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/local_scale_meteorology.jl#L5-L31">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.SurfaceLayerProfile"><a class="docstring-binding" href="#EnvironmentalTransport.SurfaceLayerProfile"><code>EnvironmentalTransport.SurfaceLayerProfile</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SurfaceLayerProfile(; name=:SurfaceLayerProfile)</code></pre><p>Returns a <code>ModelingToolkit.System</code> implementing Monin-Obukhov similarity theory for the atmospheric surface layer, including logarithmic wind profiles and stability corrections.</p><p>Based on Chapter 16 &quot;Meteorology of the Local Scale&quot; from Seinfeld &amp; Pandis (2006) &quot;Atmospheric Chemistry and Physics&quot;, 2nd Edition, pp. 720-760.</p><p>Key equations implemented:</p><ul><li>Eq. 16.66: Logarithmic wind profile ≈´(z) = (u*/Œ∫)ln(z/z‚ÇÄ)</li><li>Eq. 16.70: Monin-Obukhov length L = -œÅƒâ<em>p T‚ÇÄ u*¬≥/(Œ∫g qÃÑ</em>z)</li><li>Eq. 16.75: Businger-Dyer stability functions œÜ<em>m, œÜ</em>h</li><li>Eq. 16.78-16.79: Integrated stability functions œà<em>m, œà</em>h</li></ul><p>The system computes:</p><ul><li>Mean wind speed at height z with stability corrections</li><li>Friction velocity u*</li><li>Sensible heat flux</li><li>Stability-corrected profiles for momentum and heat</li></ul><p>Example:</p><pre><code class="language-julia hljs">using ModelingToolkit, EnvironmentalTransport

surf = SurfaceLayerProfile()
sys = mtkcompile(surf)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/local_scale_meteorology.jl#L77-L106">source</a></section></details></article><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><p>The implementation consists of three main systems:</p><ol><li><strong><code>AtmosphericStability</code></strong>: Computes potential temperature and vertical stability based on temperature gradients</li><li><strong><code>SurfaceLayerProfile</code></strong>: Implements Monin-Obukhov similarity theory for wind profiles</li><li><strong><code>LocalScaleMeteorology</code></strong>: A comprehensive system combining both stability and wind profile calculations</li></ol><h3 id="State-Variables"><a class="docs-heading-anchor" href="#State-Variables">State Variables</a><a id="State-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#State-Variables" title="Permalink"></a></h3><pre><code class="language-julia hljs">using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities
using EnvironmentalTransport

sys = LocalScaleMeteorology()
vars = unknowns(sys)

DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [ModelingToolkit.get_unit(v) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>12√ó3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Quantity{Float64, DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}}" style = "text-align: left;">Quantity‚Ä¶</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">Œ∏</td><td style = "text-align: right;">1.0 K</td><td style = "text-align: left;">Potential temperature (Eq. 16.14)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">dT_dz</td><td style = "text-align: right;">1.0 m‚Åª¬π K</td><td style = "text-align: left;">Actual temperature lapse rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">dŒ∏_dz</td><td style = "text-align: right;">1.0 m‚Åª¬π K</td><td style = "text-align: left;">Potential temperature gradient</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">L</td><td style = "text-align: right;">1.0 m</td><td style = "text-align: left;">Monin-Obukhov length (Eq. 16.70)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">L_inv</td><td style = "text-align: right;">1.0 m‚Åª¬π</td><td style = "text-align: left;">Inverse Monin-Obukhov length</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">Œ∂</td><td style = "text-align: right;">1.0 </td><td style = "text-align: left;">Stability parameter z/L (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">œÜ_m</td><td style = "text-align: right;">1.0 </td><td style = "text-align: left;">Momentum stability function (Eq. 16.75) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">œÜ_h</td><td style = "text-align: right;">1.0 </td><td style = "text-align: left;">Heat stability function (Eq. 16.75) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">œà_m</td><td style = "text-align: right;">1.0 </td><td style = "text-align: left;">Integrated momentum stability function (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">œà_h</td><td style = "text-align: right;">1.0 </td><td style = "text-align: left;">Integrated heat stability function (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">≈´</td><td style = "text-align: right;">1.0 m s‚Åª¬π</td><td style = "text-align: left;">Mean wind speed at height z (Eq. 16.66)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">pasquill_class</td><td style = "text-align: right;">1.0 </td><td style = "text-align: left;">Pasquill stability class (1=A to 6=F) (dimensionless)</td></tr></tbody></table></div><h3 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h3><pre><code class="language-julia hljs">params = parameters(sys)

DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Default =&gt; [ModelingToolkit.getdefault(p) for p in params],
    :Units =&gt; [ModelingToolkit.get_unit(p) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>28√ó4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Default</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "DynamicQuantities.Quantity{Float64, DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}}" style = "text-align: left;">Quantity‚Ä¶</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">a_B</td><td style = "text-align: right;">-0.037</td><td style = "text-align: right;">1.0 m‚Åª¬π</td><td style = "text-align: left;">Golder coefficient a for class B</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">u_star</td><td style = "text-align: right;">0.3</td><td style = "text-align: right;">1.0 m s‚Åª¬π</td><td style = "text-align: left;">Friction velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">R_air</td><td style = "text-align: right;">287.0</td><td style = "text-align: right;">1.0 m¬≤ s‚Åª¬≤ K‚Åª¬π</td><td style = "text-align: left;">Gas constant for dry air</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">Œ∫</td><td style = "text-align: right;">0.4</td><td style = "text-align: right;">1.0 </td><td style = "text-align: left;">von Karman constant (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">ƒâ_p</td><td style = "text-align: right;">1005.0</td><td style = "text-align: right;">1.0 m¬≤ s‚Åª¬≤ K‚Åª¬π</td><td style = "text-align: left;">Specific heat of air at constant pressure</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">T</td><td style = "text-align: right;">288.15</td><td style = "text-align: right;">1.0 K</td><td style = "text-align: left;">Air temperature at height z</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">T‚ÇÄ</td><td style = "text-align: right;">288.15</td><td style = "text-align: right;">1.0 K</td><td style = "text-align: left;">Reference temperature (surface)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">a_A</td><td style = "text-align: right;">-0.096</td><td style = "text-align: right;">1.0 m‚Åª¬π</td><td style = "text-align: left;">Golder coefficient a for class A</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">b_F</td><td style = "text-align: right;">-0.036</td><td style = "text-align: right;">1.0 m‚Åª¬π</td><td style = "text-align: left;">Golder coefficient b for class F</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">T_below</td><td style = "text-align: right;">288.15</td><td style = "text-align: right;">1.0 K</td><td style = "text-align: left;">Air temperature at height z - Œîz</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">a_C</td><td style = "text-align: right;">-0.002</td><td style = "text-align: right;">1.0 m‚Åª¬π</td><td style = "text-align: left;">Golder coefficient a for class C</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">b_E</td><td style = "text-align: right;">-0.018</td><td style = "text-align: right;">1.0 m‚Åª¬π</td><td style = "text-align: left;">Golder coefficient b for class E</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: left;">q_z</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">1.0 kg s‚Åª¬≥</td><td style = "text-align: left;">Surface sensible heat flux (positive upward)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: left;">z</td><td style = "text-align: right;">10.0</td><td style = "text-align: right;">1.0 m</td><td style = "text-align: left;">Height above ground</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">15</td><td style = "text-align: left;">Œµ_q</td><td style = "text-align: right;">1.0e-10</td><td style = "text-align: right;">1.0 kg s‚Åª¬≥</td><td style = "text-align: left;">Small regularization for heat flux</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">16</td><td style = "text-align: left;">Œì_d</td><td style = "text-align: right;">0.00976</td><td style = "text-align: right;">1.0 m‚Åª¬π K</td><td style = "text-align: left;">Dry adiabatic lapse rate (Eq. 16.8)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">17</td><td style = "text-align: left;">a_F</td><td style = "text-align: right;">0.035</td><td style = "text-align: right;">1.0 m‚Åª¬π</td><td style = "text-align: left;">Golder coefficient a for class F</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">18</td><td style = "text-align: left;">a_E</td><td style = "text-align: right;">0.004</td><td style = "text-align: right;">1.0 m‚Åª¬π</td><td style = "text-align: left;">Golder coefficient a for class E</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">19</td><td style = "text-align: left;">z‚ÇÄ_ref</td><td style = "text-align: right;">1.0</td><td style = "text-align: right;">1.0 m</td><td style = "text-align: left;">Reference length for dimensionless log</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">20</td><td style = "text-align: left;">œÅ</td><td style = "text-align: right;">1.225</td><td style = "text-align: right;">1.0 m‚Åª¬≥ kg</td><td style = "text-align: left;">Air density</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">21</td><td style = "text-align: left;">p</td><td style = "text-align: right;">101325.0</td><td style = "text-align: right;">1.0 m‚Åª¬π kg s‚Åª¬≤</td><td style = "text-align: left;">Pressure at height z</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">22</td><td style = "text-align: left;">z‚ÇÄ</td><td style = "text-align: right;">0.1</td><td style = "text-align: right;">1.0 m</td><td style = "text-align: left;">Roughness length (Table 16.1)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">23</td><td style = "text-align: left;">b_A</td><td style = "text-align: right;">0.029</td><td style = "text-align: right;">1.0 m‚Åª¬π</td><td style = "text-align: left;">Golder coefficient b for class A</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">24</td><td style = "text-align: left;">Œîz</td><td style = "text-align: right;">100.0</td><td style = "text-align: right;">1.0 m</td><td style = "text-align: left;">Vertical spacing for gradient calculation</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">25</td><td style = "text-align: left;">p‚ÇÄ</td><td style = "text-align: right;">101325.0</td><td style = "text-align: right;">1.0 m‚Åª¬π kg s‚Åª¬≤</td><td style = "text-align: left;">Reference pressure (sea level)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">26</td><td style = "text-align: left;">g</td><td style = "text-align: right;">9.807</td><td style = "text-align: right;">1.0 m s‚Åª¬≤</td><td style = "text-align: left;">Gravitational acceleration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">27</td><td style = "text-align: left;">b_C</td><td style = "text-align: right;">0.018</td><td style = "text-align: right;">1.0 m‚Åª¬π</td><td style = "text-align: left;">Golder coefficient b for class C</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">28</td><td style = "text-align: left;">b_B</td><td style = "text-align: right;">0.029</td><td style = "text-align: right;">1.0 m‚Åª¬π</td><td style = "text-align: left;">Golder coefficient b for class B</td></tr></tbody></table></div><h3 id="Equations"><a class="docs-heading-anchor" href="#Equations">Equations</a><a id="Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Equations" title="Permalink"></a></h3><pre><code class="language-julia hljs">eqs = equations(sys)</code></pre><p class="math-container">\[ \begin{align}
\theta\left( t \right) &amp;= \left( \frac{\mathtt{p{_0}}}{p} \right)^{\frac{\mathtt{R\_air}}{\mathtt{\hat{c}\_p}}} T \\
\mathtt{dT\_dz}\left( t \right) &amp;= \frac{T - \mathtt{T\_below}}{\mathtt{{\Delta}z}} \\
\mathtt{d\theta\_dz}\left( t \right) &amp;= \mathtt{dT\_dz}\left( t \right) + \mathtt{\Gamma\_d} \\
L\left( t \right) &amp;= \frac{ - \mathtt{u\_star}^{3} \mathtt{T{_0}} \mathtt{\hat{c}\_p} \rho}{g \left( \mathtt{q\_z} + \mathtt{\varepsilon\_q} \right) \kappa} \\
\mathtt{L\_inv}\left( t \right) &amp;= \frac{1}{L\left( t \right)} \\
\zeta\left( t \right) &amp;= \frac{z}{L\left( t \right)} \\
\mathtt{\varphi\_m}\left( t \right) &amp;= ifelse\left( \zeta\left( t \right) &lt; 0, \frac{1}{\left( 1 - 15 \zeta\left( t \right) \right)^{0.25}}, 1 + 4.7 \zeta\left( t \right) \right) \\
\mathtt{\varphi\_h}\left( t \right) &amp;= ifelse\left( \zeta\left( t \right) &lt; 0, \frac{1}{\left( 1 - 15 \zeta\left( t \right) \right)^{0.5}}, 1 + 4.7 \zeta\left( t \right) \right) \\
\mathtt{\psi\_m}\left( t \right) &amp;= ifelse\left( \zeta\left( t \right) &lt; 0, 1.5708 - 2 \arctan\left( \left( 1 - 15 \zeta\left( t \right) \right)^{0.25} \right) + 2 \log\left( \frac{1}{2} \left( 1 + \left( 1 - 15 \zeta\left( t \right) \right)^{0.25} \right) \right) + \log\left( \frac{1}{2} \left( 1 + \left( 1 - 15 \zeta\left( t \right) \right)^{0.5} \right) \right),  - 4.7 \zeta\left( t \right) \right) \\
\mathtt{\psi\_h}\left( t \right) &amp;= ifelse\left( \zeta\left( t \right) &lt; 0, 2 \log\left( \frac{1}{2} \left( 1 + \left( 1 - 15 \zeta\left( t \right) \right)^{0.5} \right) \right),  - 4.7 \zeta\left( t \right) \right) \\
\bar{u}\left( t \right) &amp;= \frac{\mathtt{u\_star} \left(  - \mathtt{\psi\_m}\left( t \right) + \log\left( \frac{z}{\mathtt{z_0}} \right) \right)}{\kappa} \\
\mathtt{pasquill\_class}\left( t \right) &amp;= ifelse\left( \mathtt{L\_inv}\left( t \right) &lt; \mathtt{a\_A} + \mathtt{b\_A} \log_{10}\left( \frac{\mathtt{z{_0}}}{\mathtt{z{_0}\_ref}} \right), 1, ifelse\left( \mathtt{L\_inv}\left( t \right) &lt; \mathtt{a\_B} + \mathtt{b\_B} \log_{10}\left( \frac{\mathtt{z{_0}}}{\mathtt{z{_0}\_ref}} \right), 2, ifelse\left( \mathtt{L\_inv}\left( t \right) &lt; \mathtt{a\_C} + \mathtt{b\_C} \log_{10}\left( \frac{\mathtt{z{_0}}}{\mathtt{z{_0}\_ref}} \right), 3, ifelse\left( \mathtt{L\_inv}\left( t \right) &lt; \mathtt{a\_E} + \mathtt{b\_E} \log_{10}\left( \frac{\mathtt{z{_0}}}{\mathtt{z{_0}\_ref}} \right), 4, ifelse\left( \mathtt{L\_inv}\left( t \right) &lt; \mathtt{a\_F} + \mathtt{b\_F} \log_{10}\left( \frac{\mathtt{z{_0}}}{\mathtt{z{_0}\_ref}} \right), 5, 6 \right) \right) \right) \right) \right)
\end{align}
 \]</p><h2 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h2><h3 id="Dry-Adiabatic-Lapse-Rate-(Eq.-16.8)"><a class="docs-heading-anchor" href="#Dry-Adiabatic-Lapse-Rate-(Eq.-16.8)">Dry Adiabatic Lapse Rate (Eq. 16.8)</a><a id="Dry-Adiabatic-Lapse-Rate-(Eq.-16.8)-1"></a><a class="docs-heading-anchor-permalink" href="#Dry-Adiabatic-Lapse-Rate-(Eq.-16.8)" title="Permalink"></a></h3><p>A key result from the first law of thermodynamics applied to an adiabatically rising air parcel is the dry adiabatic lapse rate:</p><p class="math-container">\[\Gamma = \frac{g}{\hat{c}_{p,\text{air}}} = \frac{9.807 \text{ m/s}^2}{1005 \text{ J/(kg¬∑K)}} \approx 9.76 \text{ K/km}\]</p><p>This represents the rate at which an unsaturated air parcel cools as it rises adiabatically.</p><pre><code class="language-julia hljs"># Verify the dry adiabatic lapse rate calculation
g = 9.807  # m/s¬≤
ƒâ_p = 1005.0  # J/(kg¬∑K)
Œì = g / ƒâ_p * 1000  # Convert to K/km
println(&quot;Dry adiabatic lapse rate: Œì = $(round(Œì, digits=2)) K/km&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dry adiabatic lapse rate: Œì = 9.76 K/km</code></pre><h3 id="Potential-Temperature-(Eq.-16.14)"><a class="docs-heading-anchor" href="#Potential-Temperature-(Eq.-16.14)">Potential Temperature (Eq. 16.14)</a><a id="Potential-Temperature-(Eq.-16.14)-1"></a><a class="docs-heading-anchor-permalink" href="#Potential-Temperature-(Eq.-16.14)" title="Permalink"></a></h3><p>Potential temperature is the temperature an air parcel would have if brought adiabatically to a reference pressure (typically sea level):</p><p class="math-container">\[\theta = T \left(\frac{p_0}{p}\right)^{R/(c_p M_{\text{air}})} = T \left(\frac{p_0}{p}\right)^{0.286}\]</p><pre><code class="language-julia hljs">using OrdinaryDiffEqDefault, Plots
default(size = (700, 400))

sys = LocalScaleMeteorology()
csys = mtkcompile(sys)

# Calculate potential temperature at different pressure levels
pressures = range(101325, 50000, length = 20)  # Pa
T_ambient = 288.15 .- 0.0065 .* (1 .- pressures ./ 101325) .* 8500  # Approximate T profile

Œ∏_values = Float64[]
for (p, T) in zip(pressures, T_ambient)
    prob = ODEProblem(csys, Dict(), (0.0, 1.0), Dict(csys.T =&gt; T, csys.p =&gt; p))
    sol = solve(prob)
    push!(Œ∏_values, sol[csys.Œ∏][end])
end

plot(Œ∏_values, pressures ./ 100,
    xlabel = &quot;Potential Temperature (K)&quot;,
    ylabel = &quot;Pressure (hPa)&quot;,
    yflip = true,
    label = &quot;Œ∏&quot;,
    linewidth = 2,
    title = &quot;Potential Temperature Profile&quot;)</code></pre><img src="03842797.svg" alt="Example block output"/><h3 id="Atmospheric-Stability-Classification"><a class="docs-heading-anchor" href="#Atmospheric-Stability-Classification">Atmospheric Stability Classification</a><a id="Atmospheric-Stability-Classification-1"></a><a class="docs-heading-anchor-permalink" href="#Atmospheric-Stability-Classification" title="Permalink"></a></h3><p>Atmospheric stability determines the tendency of vertically displaced air parcels to return to equilibrium or continue moving. The stability is characterized by the potential temperature gradient:</p><ul><li><strong>Stable</strong> (<span>$\partial\theta/\partial z &gt; 0$</span>): Displaced parcels return to original position</li><li><strong>Neutral</strong> (<span>$\partial\theta/\partial z = 0$</span>): Displaced parcels remain at new position</li><li><strong>Unstable</strong> (<span>$\partial\theta/\partial z &lt; 0$</span>): Displaced parcels accelerate away</li></ul><pre><code class="language-julia hljs">sys = AtmosphericStability()
csys = mtkcompile(sys)

T_surface = 288.15  # K
Œîz = 100.0  # m

# Three stability cases
cases = [
    (&quot;Stable (weak lapse)&quot;, T_surface - 0.005 * Œîz),      # 0.5 K/100m
    (&quot;Neutral (adiabatic)&quot;, T_surface - 0.00976 * Œîz),    # ~9.76 K/km
    (&quot;Unstable (superadiabatic)&quot;, T_surface - 0.015 * Œîz)  # 1.5 K/100m
]

results = []
for (label, T_above) in cases
    prob = ODEProblem(csys, Dict(), (0.0, 1.0),
        Dict(csys.T =&gt; T_above, csys.T_below =&gt; T_surface, csys.Œîz =&gt; Œîz))
    sol = solve(prob)
    push!(results, (label = label, S = sol[csys.S][end] * 1000))  # K/km
end

DataFrame(results)</code></pre><div><div style = "float: left;"><span>3√ó2 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">label</th><th style = "text-align: left;">S</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">Stable (weak lapse)</td><td style = "text-align: right;">4.76</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">Neutral (adiabatic)</td><td style = "text-align: right;">8.67362e-15</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">Unstable (superadiabatic)</td><td style = "text-align: right;">-5.24</td></tr></tbody></table></div><h3 id="Monin-Obukhov-Similarity-Theory"><a class="docs-heading-anchor" href="#Monin-Obukhov-Similarity-Theory">Monin-Obukhov Similarity Theory</a><a id="Monin-Obukhov-Similarity-Theory-1"></a><a class="docs-heading-anchor-permalink" href="#Monin-Obukhov-Similarity-Theory" title="Permalink"></a></h3><p>The Monin-Obukhov length <span>$L$</span> is a fundamental scaling parameter that characterizes the relative importance of mechanical and thermal turbulence production:</p><p class="math-container">\[L = -\frac{\rho \hat{c}_p T_0 u_*^3}{\kappa g \bar{q}_z}\]</p><p>where:</p><ul><li><span>$u_*$</span> is the friction velocity</li><li><span>$\bar{q}_z$</span> is the surface sensible heat flux</li><li><span>$\kappa = 0.4$</span> is the von Karman constant</li></ul><pre><code class="language-julia hljs">sys = SurfaceLayerProfile()
csys = mtkcompile(sys)

# Calculate Monin-Obukhov length for different heat flux conditions
heat_fluxes = range(-100, 200, length = 50)  # W/m¬≤
L_values = Float64[]

for q in heat_fluxes
    if abs(q) &lt; 1e-6
        push!(L_values, NaN)  # Avoid singularity
        continue
    end
    prob = ODEProblem(csys, Dict(), (0.0, 1.0),
        Dict(csys.u_star =&gt; 0.3, csys.q_z =&gt; q))
    sol = solve(prob)
    L_val = sol[csys.L][end]
    push!(L_values, clamp(L_val, -500, 500))  # Clamp for visualization
end

plot(heat_fluxes, L_values,
    xlabel = &quot;Surface Heat Flux (W/m¬≤)&quot;,
    ylabel = &quot;Monin-Obukhov Length L (m)&quot;,
    label = &quot;L&quot;,
    linewidth = 2,
    title = &quot;Monin-Obukhov Length vs Heat Flux\n(u* = 0.3 m/s)&quot;,
    ylims = (-500, 500))
hline!([0], linestyle = :dash, color = :gray, label = &quot;&quot;)
vline!([0], linestyle = :dash, color = :gray, label = &quot;&quot;)
annotate!([(100, -200, text(&quot;Unstable\n(L &lt; 0)&quot;, 8)),
    (-50, 200, text(&quot;Stable\n(L &gt; 0)&quot;, 8))])</code></pre><img src="bbc9e3be.svg" alt="Example block output"/><h3 id="Businger-Dyer-Stability-Functions-(Eq.-16.75)"><a class="docs-heading-anchor" href="#Businger-Dyer-Stability-Functions-(Eq.-16.75)">Businger-Dyer Stability Functions (Eq. 16.75)</a><a id="Businger-Dyer-Stability-Functions-(Eq.-16.75)-1"></a><a class="docs-heading-anchor-permalink" href="#Businger-Dyer-Stability-Functions-(Eq.-16.75)" title="Permalink"></a></h3><p>The universal functions <span>$\phi_m(\zeta)$</span> and <span>$\phi_h(\zeta)$</span> describe how momentum and heat transfer deviate from neutral conditions:</p><p><strong>Unstable</strong> (<span>$\zeta &lt; 0$</span>):</p><p class="math-container">\[\phi_m = (1 - 15\zeta)^{-1/4}, \quad \phi_h = (1 - 15\zeta)^{-1/2}\]</p><p><strong>Stable</strong> (<span>$\zeta &gt; 0$</span>):</p><p class="math-container">\[\phi_m = \phi_h = 1 + 4.7\zeta\]</p><pre><code class="language-julia hljs"># Plot stability functions
Œ∂_unstable = range(-2, 0, length = 50)
Œ∂_stable = range(0, 2, length = 50)
Œ∂_all = vcat(Œ∂_unstable, Œ∂_stable)

œÜ_m_unstable = (1 .- 15 .* Œ∂_unstable) .^ (-0.25)
œÜ_m_stable = 1 .+ 4.7 .* Œ∂_stable
œÜ_m_all = vcat(œÜ_m_unstable, œÜ_m_stable)

œÜ_h_unstable = (1 .- 15 .* Œ∂_unstable) .^ (-0.5)
œÜ_h_stable = 1 .+ 4.7 .* Œ∂_stable
œÜ_h_all = vcat(œÜ_h_unstable, œÜ_h_stable)

plot(Œ∂_all, œÜ_m_all, label = &quot;œÜ_m (momentum)&quot;, linewidth = 2)
plot!(Œ∂_all, œÜ_h_all, label = &quot;œÜ_h (heat)&quot;, linewidth = 2)
xlabel!(&quot;Œ∂ = z/L&quot;)
ylabel!(&quot;œÜ&quot;)
title!(&quot;Businger-Dyer Stability Functions (Eq. 16.75)&quot;)
hline!([1], linestyle = :dash, color = :gray, label = &quot;Neutral&quot;)
vline!([0], linestyle = :dash, color = :gray, label = &quot;&quot;)</code></pre><img src="cccd64c8.svg" alt="Example block output"/><h3 id="Logarithmic-Wind-Profile-(Eq.-16.66)"><a class="docs-heading-anchor" href="#Logarithmic-Wind-Profile-(Eq.-16.66)">Logarithmic Wind Profile (Eq. 16.66)</a><a id="Logarithmic-Wind-Profile-(Eq.-16.66)-1"></a><a class="docs-heading-anchor-permalink" href="#Logarithmic-Wind-Profile-(Eq.-16.66)" title="Permalink"></a></h3><p>The wind velocity in the surface layer follows a logarithmic profile with stability corrections:</p><p class="math-container">\[\bar{u}(z) = \frac{u_*}{\kappa}\left[\ln\left(\frac{z}{z_0}\right) - \psi_m(\zeta)\right]\]</p><p>where <span>$\psi_m$</span> is the integrated stability function.</p><pre><code class="language-julia hljs">sys = SurfaceLayerProfile()
csys = mtkcompile(sys)

# Wind profiles for different stability conditions
heights = range(1, 50, length = 30)  # m
z‚ÇÄ = 0.1  # m
u_star = 0.4  # m/s

# Neutral, stable, and unstable profiles
stabilities = [
    (&quot;Neutral&quot;, 1e-8),
    (&quot;Stable&quot;, -50.0),  # Negative flux = downward = stable
    (&quot;Unstable&quot;, 100.0)  # Positive flux = upward = unstable
]

p = plot(
    title = &quot;Wind Profiles for Different Stability Conditions\n(u* = 0.4 m/s, z‚ÇÄ = 0.1 m)&quot;,
    xlabel = &quot;Wind Speed (m/s)&quot;, ylabel = &quot;Height (m)&quot;)

for (label, q_z) in stabilities
    u_values = Float64[]
    for z in heights
        prob = ODEProblem(csys, Dict(), (0.0, 1.0),
            Dict(csys.z =&gt; z, csys.z‚ÇÄ =&gt; z‚ÇÄ, csys.u_star =&gt; u_star, csys.q_z =&gt; q_z))
        sol = solve(prob)
        push!(u_values, sol[csys.≈´][end])
    end
    plot!(p, u_values, heights, label = label, linewidth = 2)
end
p</code></pre><img src="85170b23.svg" alt="Example block output"/><h3 id="Pasquill-Stability-Classes-(Table-16.4)"><a class="docs-heading-anchor" href="#Pasquill-Stability-Classes-(Table-16.4)">Pasquill Stability Classes (Table 16.4)</a><a id="Pasquill-Stability-Classes-(Table-16.4)-1"></a><a class="docs-heading-anchor-permalink" href="#Pasquill-Stability-Classes-(Table-16.4)" title="Permalink"></a></h3><p>The Pasquill-Gifford stability classification provides a practical way to categorize atmospheric stability based on observable meteorological conditions:</p><table><tr><th style="text-align: center">Class</th><th style="text-align: left">Description</th><th style="text-align: left">Conditions</th></tr><tr><td style="text-align: center">A</td><td style="text-align: left">Very unstable</td><td style="text-align: left">Strong daytime insolation, light winds</td></tr><tr><td style="text-align: center">B</td><td style="text-align: left">Moderately unstable</td><td style="text-align: left">Moderate daytime insolation</td></tr><tr><td style="text-align: center">C</td><td style="text-align: left">Slightly unstable</td><td style="text-align: left">Weak daytime insolation</td></tr><tr><td style="text-align: center">D</td><td style="text-align: left">Neutral</td><td style="text-align: left">Overcast or high winds</td></tr><tr><td style="text-align: center">E</td><td style="text-align: left">Slightly stable</td><td style="text-align: left">Night, partial cloud cover</td></tr><tr><td style="text-align: center">F</td><td style="text-align: left">Moderately stable</td><td style="text-align: left">Night, clear skies, light winds</td></tr></table><p>The Golder (1972) correlation relates Pasquill classes to Monin-Obukhov length via:</p><p class="math-container">\[\frac{1}{L} = a + b \cdot \log_{10}(z_0)\]</p><pre><code class="language-julia hljs"># Golder correlation coefficients
golder_params = [
    (&quot;A&quot;, -0.096, 0.029),
    (&quot;B&quot;, -0.037, 0.029),
    (&quot;C&quot;, -0.002, 0.018),
    (&quot;D&quot;, 0.000, 0.000),
    (&quot;E&quot;, 0.004, -0.018),
    (&quot;F&quot;, 0.035, -0.036)
]

z0_range = 10 .^ range(-4, 1, length = 100)  # m

p = plot(
    title = &quot;Monin-Obukhov Length vs Roughness Length\nfor Pasquill Stability Classes (Eq. 16.83)&quot;,
    xlabel = &quot;Roughness Length z‚ÇÄ (m)&quot;, ylabel = &quot;1/L (m‚Åª¬π)&quot;,
    xscale = :log10, legend = :topright)

for (class, a, b) in golder_params
    L_inv = a .+ b .* log10.(z0_range)
    plot!(p, z0_range, L_inv, label = &quot;Class $class&quot;, linewidth = 2)
end
hline!([0], linestyle = :dash, color = :gray, label = &quot;Neutral&quot;)
ylims!(-0.15, 0.1)
p</code></pre><img src="c2092e4a.svg" alt="Example block output"/><h3 id="Example:-Complete-Boundary-Layer-Analysis"><a class="docs-heading-anchor" href="#Example:-Complete-Boundary-Layer-Analysis">Example: Complete Boundary Layer Analysis</a><a id="Example:-Complete-Boundary-Layer-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Complete-Boundary-Layer-Analysis" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys = LocalScaleMeteorology()
csys = mtkcompile(sys)

# Summer afternoon conditions
conditions = Dict(
    csys.T =&gt; 298.15,        # 25¬∞C at 10m
    csys.T_below =&gt; 300.15,  # 27¬∞C at surface (superadiabatic)
    csys.p =&gt; 100000.0,      # ~sea level
    csys.z =&gt; 10.0,          # 10m measurement height
    csys.z‚ÇÄ =&gt; 0.1,          # Grassland
    csys.Œîz =&gt; 10.0,         # 10m vertical spacing
    csys.T‚ÇÄ =&gt; 300.15,       # Surface temperature
    csys.œÅ =&gt; 1.18,          # Air density
    csys.u_star =&gt; 0.35,     # Moderate friction
    csys.q_z =&gt; 150.0        # Strong upward heat flux (sunny afternoon)
)

prob = ODEProblem(csys, Dict(), (0.0, 1.0), conditions)
sol = solve(prob)

println(&quot;=== Summer Afternoon Boundary Layer Analysis ===\n&quot;)
println(&quot;Potential temperature: Œ∏ = $(round(sol[csys.Œ∏][end], digits=1)) K&quot;)
println(&quot;Stability (dŒ∏/dz): $(round(sol[csys.dŒ∏_dz][end] * 1000, digits=2)) K/km&quot;)
println(&quot;Monin-Obukhov length: L = $(round(sol[csys.L][end], digits=1)) m&quot;)
println(&quot;Stability parameter: Œ∂ = $(round(sol[csys.Œ∂][end], digits=3))&quot;)
println(&quot;Wind speed at 10m: ≈´ = $(round(sol[csys.≈´][end], digits=2)) m/s&quot;)
println(&quot;Pasquill class: $(Int(round(sol[csys.pasquill_class][end]))) (1=A to 6=F)&quot;)

# Interpret the results
L_val = sol[csys.L][end]
stability = L_val &lt; 0 ? &quot;UNSTABLE&quot; : (L_val &gt; 0 ? &quot;STABLE&quot; : &quot;NEUTRAL&quot;)
println(&quot;\nInterpretation: Atmosphere is $stability (typical for sunny afternoon)&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">‚îå Warning: `SciMLBase.ODEProblem(sys, u0, tspan, p; kw...)` is deprecated. Use
‚îÇ `SciMLBase.ODEProblem(sys, merge(u0, p), tspan)` instead.
‚îî @ ModelingToolkit ~/.julia/packages/ModelingToolkit/JvjlW/src/deprecations.jl:45
=== Summer Afternoon Boundary Layer Analysis ===

Potential temperature: Œ∏ = 299.3 K
Stability (dŒ∏/dz): -190.24 K/km
Monin-Obukhov length: L = -25.9 m
Stability parameter: Œ∂ = -0.386
Wind speed at 10m: ≈´ = 3.45 m/s
Pasquill class: 3 (1=A to 6=F)

Interpretation: Atmosphere is UNSTABLE (typical for sunny afternoon)</code></pre><h2 id="Roughness-Length-Reference-(Table-16.1)"><a class="docs-heading-anchor" href="#Roughness-Length-Reference-(Table-16.1)">Roughness Length Reference (Table 16.1)</a><a id="Roughness-Length-Reference-(Table-16.1)-1"></a><a class="docs-heading-anchor-permalink" href="#Roughness-Length-Reference-(Table-16.1)" title="Permalink"></a></h2><p>The roughness length <span>$z_0$</span> depends on surface characteristics:</p><table><tr><th style="text-align: left">Surface Type</th><th style="text-align: center">z‚ÇÄ (m)</th></tr><tr><td style="text-align: left">Very smooth (ice, mud flats)</td><td style="text-align: center">10‚Åª‚Åµ</td></tr><tr><td style="text-align: left">Snow, smooth sea, level desert</td><td style="text-align: center">10‚Åª¬≥</td></tr><tr><td style="text-align: left">Lawn</td><td style="text-align: center">10‚Åª¬≤</td></tr><tr><td style="text-align: left">Uncut grass</td><td style="text-align: center">0.05</td></tr><tr><td style="text-align: left">Full-grown root crops</td><td style="text-align: center">0.1</td></tr><tr><td style="text-align: left">Tree-covered terrain</td><td style="text-align: center">1</td></tr><tr><td style="text-align: left">Low-density residential</td><td style="text-align: center">2</td></tr><tr><td style="text-align: left">Central business district</td><td style="text-align: center">5-10</td></tr></table></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../seinfeld_pandis_ch1/">¬´ Atmospheric Fundamentals</a><a class="docs-footer-nextpage" href="../api/">API ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 4 February 2026 20:08">Wednesday 4 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
