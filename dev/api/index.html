<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API ¬∑ EnvironmentalTransport.jl</title><meta name="title" content="API ¬∑ EnvironmentalTransport.jl"/><meta property="og:title" content="API ¬∑ EnvironmentalTransport.jl"/><meta property="twitter:title" content="API ¬∑ EnvironmentalTransport.jl"/><meta name="description" content="Documentation for EnvironmentalTransport.jl."/><meta property="og:description" content="Documentation for EnvironmentalTransport.jl."/><meta property="twitter:description" content="Documentation for EnvironmentalTransport.jl."/><meta property="og:url" content="https://EarthSciML.github.io/EnvironmentalTransport.jl/api/"/><meta property="twitter:url" content="https://EarthSciML.github.io/EnvironmentalTransport.jl/api/"/><link rel="canonical" href="https://EarthSciML.github.io/EnvironmentalTransport.jl/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">EnvironmentalTransport.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../advection/">Advection</a></li><li><a class="tocitem" href="../puff/">Puff Model</a></li><li><a class="tocitem" href="../seinfeld_pandis_ch1/">Atmospheric Fundamentals</a></li><li><a class="tocitem" href="../local_scale_meteorology/">Local Scale Meteorology</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#API-Documentation"><span>API Documentation</span></a></li></ul></li><li><a class="tocitem" href="../benchmarks/">üîó Benchmarks</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EarthSciML/EnvironmentalTransport.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/main/docs/src/api.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Index"><a class="docs-heading-anchor" href="#API-Index">API Index</a><a id="API-Index-1"></a><a class="docs-heading-anchor-permalink" href="#API-Index" title="Permalink"></a></h1><ul><li><a href="#EnvironmentalTransport.AdvectionOperator"><code>EnvironmentalTransport.AdvectionOperator</code></a></li><li><a href="#EnvironmentalTransport.BCArray"><code>EnvironmentalTransport.BCArray</code></a></li><li><a href="#EnvironmentalTransport.ConstantBC"><code>EnvironmentalTransport.ConstantBC</code></a></li><li><a href="#EnvironmentalTransport.ConstantBCArray"><code>EnvironmentalTransport.ConstantBCArray</code></a></li><li><a href="#EnvironmentalTransport.PBLMixingCallback"><code>EnvironmentalTransport.PBLMixingCallback</code></a></li><li><a href="#EnvironmentalTransport.SpeciesConstantBC"><code>EnvironmentalTransport.SpeciesConstantBC</code></a></li><li><a href="#EnvironmentalTransport.SpeciesConstantBCArray"><code>EnvironmentalTransport.SpeciesConstantBCArray</code></a></li><li><a href="#EnvironmentalTransport.ZeroGradBC"><code>EnvironmentalTransport.ZeroGradBC</code></a></li><li><a href="#EnvironmentalTransport.ZeroGradBCArray"><code>EnvironmentalTransport.ZeroGradBCArray</code></a></li><li><a href="#EarthSciMLBase.init_callback-Tuple{PBLMixingCallback, EarthSciMLBase.CoupledSystem, Any, Any, EarthSciMLBase.DomainInfo, Any}"><code>EarthSciMLBase.init_callback</code></a></li><li><a href="../seinfeld_pandis_ch1/#EnvironmentalTransport.AtmosphericPressureProfile"><code>EnvironmentalTransport.AtmosphericPressureProfile</code></a></li><li><a href="#EnvironmentalTransport.AtmosphericPressureProfile-Tuple{}"><code>EnvironmentalTransport.AtmosphericPressureProfile</code></a></li><li><a href="#EnvironmentalTransport.AtmosphericStability-Tuple{}"><code>EnvironmentalTransport.AtmosphericStability</code></a></li><li><a href="../local_scale_meteorology/#EnvironmentalTransport.AtmosphericStability"><code>EnvironmentalTransport.AtmosphericStability</code></a></li><li><a href="#EnvironmentalTransport.AtmosphericThermodynamics-Tuple{}"><code>EnvironmentalTransport.AtmosphericThermodynamics</code></a></li><li><a href="../seinfeld_pandis_ch1/#EnvironmentalTransport.AtmosphericThermodynamics"><code>EnvironmentalTransport.AtmosphericThermodynamics</code></a></li><li><a href="#EnvironmentalTransport.BarometricFormula-Tuple{}"><code>EnvironmentalTransport.BarometricFormula</code></a></li><li><a href="../seinfeld_pandis_ch1/#EnvironmentalTransport.BarometricFormula"><code>EnvironmentalTransport.BarometricFormula</code></a></li><li><a href="#EnvironmentalTransport.GaussianPGB-Tuple{}"><code>EnvironmentalTransport.GaussianPGB</code></a></li><li><a href="#EnvironmentalTransport.GaussianSD-Tuple{}"><code>EnvironmentalTransport.GaussianSD</code></a></li><li><a href="#EnvironmentalTransport.IdealGasLaw-Tuple{}"><code>EnvironmentalTransport.IdealGasLaw</code></a></li><li><a href="../seinfeld_pandis_ch1/#EnvironmentalTransport.IdealGasLaw"><code>EnvironmentalTransport.IdealGasLaw</code></a></li><li><a href="../local_scale_meteorology/#EnvironmentalTransport.LocalScaleMeteorology"><code>EnvironmentalTransport.LocalScaleMeteorology</code></a></li><li><a href="#EnvironmentalTransport.LocalScaleMeteorology-Tuple{}"><code>EnvironmentalTransport.LocalScaleMeteorology</code></a></li><li><a href="#EnvironmentalTransport.MixingRatio-Tuple{}"><code>EnvironmentalTransport.MixingRatio</code></a></li><li><a href="../seinfeld_pandis_ch1/#EnvironmentalTransport.MixingRatio"><code>EnvironmentalTransport.MixingRatio</code></a></li><li><a href="../seinfeld_pandis_ch1/#EnvironmentalTransport.PartialPressureMixingRatio"><code>EnvironmentalTransport.PartialPressureMixingRatio</code></a></li><li><a href="#EnvironmentalTransport.PartialPressureMixingRatio-Tuple{}"><code>EnvironmentalTransport.PartialPressureMixingRatio</code></a></li><li><a href="#EnvironmentalTransport.Puff-Tuple{EarthSciMLBase.DomainInfo}"><code>EnvironmentalTransport.Puff</code></a></li><li><a href="../seinfeld_pandis_ch1/#EnvironmentalTransport.RelativeHumidity"><code>EnvironmentalTransport.RelativeHumidity</code></a></li><li><a href="#EnvironmentalTransport.RelativeHumidity-Tuple{}"><code>EnvironmentalTransport.RelativeHumidity</code></a></li><li><a href="../seinfeld_pandis_ch1/#EnvironmentalTransport.SaturationVaporPressure"><code>EnvironmentalTransport.SaturationVaporPressure</code></a></li><li><a href="#EnvironmentalTransport.SaturationVaporPressure-Tuple{}"><code>EnvironmentalTransport.SaturationVaporPressure</code></a></li><li><a href="#EnvironmentalTransport.ScaleHeight-Tuple{}"><code>EnvironmentalTransport.ScaleHeight</code></a></li><li><a href="../seinfeld_pandis_ch1/#EnvironmentalTransport.ScaleHeight"><code>EnvironmentalTransport.ScaleHeight</code></a></li><li><a href="#EnvironmentalTransport.Sofiev2012PlumeRise-Tuple{}"><code>EnvironmentalTransport.Sofiev2012PlumeRise</code></a></li><li><a href="#EnvironmentalTransport.SurfaceLayerProfile-Tuple{}"><code>EnvironmentalTransport.SurfaceLayerProfile</code></a></li><li><a href="../local_scale_meteorology/#EnvironmentalTransport.SurfaceLayerProfile"><code>EnvironmentalTransport.SurfaceLayerProfile</code></a></li><li><a href="../seinfeld_pandis_ch1/#EnvironmentalTransport.TotalMolarConcentration"><code>EnvironmentalTransport.TotalMolarConcentration</code></a></li><li><a href="#EnvironmentalTransport.TotalMolarConcentration-Tuple{}"><code>EnvironmentalTransport.TotalMolarConcentration</code></a></li><li><a href="#EnvironmentalTransport.WaterVaporThermodynamics-Tuple{}"><code>EnvironmentalTransport.WaterVaporThermodynamics</code></a></li><li><a href="../seinfeld_pandis_ch1/#EnvironmentalTransport.WaterVaporThermodynamics"><code>EnvironmentalTransport.WaterVaporThermodynamics</code></a></li><li><a href="#EnvironmentalTransport.advection_kernel_4d"><code>EnvironmentalTransport.advection_kernel_4d</code></a></li><li><a href="#EnvironmentalTransport.advection_op-Tuple{Any, Any, Any, Any, Any, Any, EarthSciMLBase.MapAlgorithm}"><code>EnvironmentalTransport.advection_op</code></a></li><li><a href="#EnvironmentalTransport.air_mass_from_pressure-Tuple{Vector{Float64}, Float64}"><code>EnvironmentalTransport.air_mass_from_pressure</code></a></li><li><a href="#EnvironmentalTransport.compute_imix_fpbl-Tuple{Vector{Float64}, Float64}"><code>EnvironmentalTransport.compute_imix_fpbl</code></a></li><li><a href="#EnvironmentalTransport.extract_domain_pressure_edges-Tuple{AbstractRange}"><code>EnvironmentalTransport.extract_domain_pressure_edges</code></a></li><li><a href="#EnvironmentalTransport.get_vf-Tuple{Any, AbstractString, Any}"><code>EnvironmentalTransport.get_vf</code></a></li><li><a href="#EnvironmentalTransport.get_Œî-Tuple{EarthSciMLBase.DomainInfo, Any, Any}"><code>EnvironmentalTransport.get_Œî</code></a></li><li><a href="#EnvironmentalTransport.pbl_full_mix!-Tuple{Matrix{Float64}, Vector{Float64}, Int64, Float64}"><code>EnvironmentalTransport.pbl_full_mix!</code></a></li><li><a href="#EnvironmentalTransport.pbl_obs_function-NTuple{4, Any}"><code>EnvironmentalTransport.pbl_obs_function</code></a></li><li><a href="#EnvironmentalTransport.resolve_species_bc-Tuple{SpeciesConstantBC, Any, Any}"><code>EnvironmentalTransport.resolve_species_bc</code></a></li><li><a href="#EnvironmentalTransport.stencil_size-Tuple{typeof(upwind1_stencil)}"><code>EnvironmentalTransport.stencil_size</code></a></li><li><a href="#EnvironmentalTransport.upwind1_stencil-NTuple{4, Any}"><code>EnvironmentalTransport.upwind1_stencil</code></a></li><li><a href="#EnvironmentalTransport.vf_x-Tuple{Any, Any}"><code>EnvironmentalTransport.vf_x</code></a></li><li><a href="#EnvironmentalTransport.vf_y-Tuple{Any, Any}"><code>EnvironmentalTransport.vf_y</code></a></li><li><a href="#EnvironmentalTransport.vf_z-Tuple{Any, Any}"><code>EnvironmentalTransport.vf_z</code></a></li><li><a href="#EnvironmentalTransport.Œîf-Tuple{Any, Any}"><code>EnvironmentalTransport.Œîf</code></a></li></ul><h1 id="API-Documentation"><a class="docs-heading-anchor" href="#API-Documentation">API Documentation</a><a id="API-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#API-Documentation" title="Permalink"></a></h1><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.AdvectionOperator"><a class="docstring-binding" href="#EnvironmentalTransport.AdvectionOperator"><code>EnvironmentalTransport.AdvectionOperator</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><p>Create an <code>EarthSciMLBase.Operator</code> that performs advection. Advection is performed using the given <code>stencil</code> operator (e.g. <code>l94_stencil</code> or <code>ppm_stencil</code>). <code>p</code> is an optional parameter set to be used by the stencil operator. <code>bc_type</code> is the boundary condition type, e.g. <code>ZeroGradBC()</code>.</p><p>Wind field data will be added in automatically if available. Currently the only valid source of wind data is <code>EarthSciData.GEOSFP</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/advection.jl#L165">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.BCArray"><a class="docstring-binding" href="#EnvironmentalTransport.BCArray"><code>EnvironmentalTransport.BCArray</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><p>An array with external indexing implemented for boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/boundary_conditions.jl#L3-L5">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.ConstantBC"><a class="docstring-binding" href="#EnvironmentalTransport.ConstantBC"><code>EnvironmentalTransport.ConstantBC</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><p>Constant boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/boundary_conditions.jl#L66">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.ConstantBCArray"><a class="docstring-binding" href="#EnvironmentalTransport.ConstantBCArray"><code>EnvironmentalTransport.ConstantBCArray</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><p>An array with zero constant boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/boundary_conditions.jl#L41">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.PBLMixingCallback"><a class="docstring-binding" href="#EnvironmentalTransport.PBLMixingCallback"><code>EnvironmentalTransport.PBLMixingCallback</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">PBLMixingCallback &lt;: EarthSciMLBase.Operator</code></pre><p>A callback that applies planetary boundary layer (PBL) mixing to tracer fields at periodic intervals. PBL mixing is a discrete process that redistributes tracers vertically within each grid column.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/PBL_mixing.jl#L165-L170">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.SpeciesConstantBC"><a class="docstring-binding" href="#EnvironmentalTransport.SpeciesConstantBC"><code>EnvironmentalTransport.SpeciesConstantBC</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><p>Species-specific constant boundary conditions. Takes a dictionary mapping species names/indices to boundary values and a default value.</p><p>Examples:</p><ul><li><code>SpeciesConstantBC(Dict(&quot;O3&quot; =&gt; 40.0), 0.0)</code> sets O3 to 40.0 and others to 0.0</li><li><code>SpeciesConstantBC(Dict(1 =&gt; 40.0), 0.0)</code> sets species 1 to 40.0 and others to 0.0</li><li><code>SpeciesConstantBC(Dict(&quot;O3&quot; =&gt; 40.0, &quot;NO2&quot; =&gt; 10.0), 0.0)</code> sets multiple species</li></ul><p>Note: When using species names, they will be resolved to indices when the boundary  condition is applied to a system with known species variables.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/boundary_conditions.jl#L110">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.SpeciesConstantBCArray"><a class="docstring-binding" href="#EnvironmentalTransport.SpeciesConstantBCArray"><code>EnvironmentalTransport.SpeciesConstantBCArray</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><p>An array with species-specific constant boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/boundary_conditions.jl#L76">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.ZeroGradBC"><a class="docstring-binding" href="#EnvironmentalTransport.ZeroGradBC"><code>EnvironmentalTransport.ZeroGradBC</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><p>Zero gradient boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/boundary_conditions.jl#L33">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.ZeroGradBCArray"><a class="docstring-binding" href="#EnvironmentalTransport.ZeroGradBCArray"><code>EnvironmentalTransport.ZeroGradBCArray</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><p>An array with zero gradient boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/boundary_conditions.jl#L8">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EarthSciMLBase.init_callback-Tuple{PBLMixingCallback, EarthSciMLBase.CoupledSystem, Any, Any, EarthSciMLBase.DomainInfo, Any}"><a class="docstring-binding" href="#EarthSciMLBase.init_callback-Tuple{PBLMixingCallback, EarthSciMLBase.CoupledSystem, Any, Any, EarthSciMLBase.DomainInfo, Any}"><code>EarthSciMLBase.init_callback</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">EarthSciMLBase.init_callback(cb::PBLMixingCallback, csys::CoupledSystem, sys_mtk, coord_args, domain::DomainInfo, alg)</code></pre><p>Initialize the PBL mixing callback.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/PBL_mixing.jl#L180-L184">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.AtmosphericPressureProfile-Tuple{}"><a class="docstring-binding" href="#EnvironmentalTransport.AtmosphericPressureProfile-Tuple{}"><code>EnvironmentalTransport.AtmosphericPressureProfile</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">AtmosphericPressureProfile(; name=:AtmosphericPressureProfile)</code></pre><p>Calculates atmospheric pressure as a function of altitude for an isothermal atmosphere.</p><p>Implements:</p><ul><li>Equation 1.1: dp/dz = -rho * g (hydrostatic equation)</li><li>Equation 1.3: dp/dz = -M_air * g * p / (R * T) (combined form)</li><li>Equation 1.5: p(z)/p_0 = exp(-z/H) (barometric formula, isothermal case)</li></ul><p>This component uses the barometric formula (Eq. 1.5) which is the integrated form of the hydrostatic equation for an isothermal atmosphere.</p><p>Note: For a non-isothermal atmosphere, the scale height varies with altitude and numerical integration of Eq. 1.3 would be required.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/seinfeld_pandis_ch1.jl#L134-L150">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.AtmosphericStability-Tuple{}"><a class="docstring-binding" href="#EnvironmentalTransport.AtmosphericStability-Tuple{}"><code>EnvironmentalTransport.AtmosphericStability</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">AtmosphericStability(; name=:AtmosphericStability)</code></pre><p>Returns a <code>ModelingToolkit.System</code> that computes atmospheric stability parameters including potential temperature, dry adiabatic lapse rate, and stability classification.</p><p>Based on Chapter 16 &quot;Meteorology of the Local Scale&quot; from Seinfeld &amp; Pandis (2006) &quot;Atmospheric Chemistry and Physics&quot;, 2nd Edition, pp. 720-760.</p><p>Key equations implemented:</p><ul><li>Eq. 16.8: Dry adiabatic lapse rate Œì = g/ƒâ_p ‚âà 9.76 K/km</li><li>Eq. 16.14: Potential temperature Œ∏ = T(p‚ÇÄ/p)^(R/ƒâ_p)</li><li>Eq. 16.16-16.18: Stability classification based on ‚àÇŒ∏/‚àÇz</li></ul><p>The stability parameter S indicates:</p><ul><li>S &gt; 0: Stable atmosphere (‚àÇŒ∏/‚àÇz &gt; 0)</li><li>S = 0: Neutral atmosphere (‚àÇŒ∏/‚àÇz = 0)</li><li>S &lt; 0: Unstable atmosphere (‚àÇŒ∏/‚àÇz &lt; 0)</li></ul><p>Example:</p><pre><code class="language-julia hljs">using ModelingToolkit, EnvironmentalTransport

stab = AtmosphericStability()
sys = mtkcompile(stab)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/local_scale_meteorology.jl#L5-L31">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.AtmosphericThermodynamics-Tuple{}"><a class="docstring-binding" href="#EnvironmentalTransport.AtmosphericThermodynamics-Tuple{}"><code>EnvironmentalTransport.AtmosphericThermodynamics</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">AtmosphericThermodynamics(; name=:AtmosphericThermodynamics)</code></pre><p>Complete atmospheric thermodynamics system combining:</p><ul><li>Equation 1.2: Ideal gas law for density</li><li>Equation 1.4: Scale height</li><li>Equation 1.5: Barometric formula</li><li>Equation 1.7: Total molar concentration</li></ul><p>This composite system calculates pressure, density, scale height, and total molar concentration given altitude and temperature for an isothermal atmosphere.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/seinfeld_pandis_ch1.jl#L465-L478">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.BarometricFormula-Tuple{}"><a class="docstring-binding" href="#EnvironmentalTransport.BarometricFormula-Tuple{}"><code>EnvironmentalTransport.BarometricFormula</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">BarometricFormula(; name=:BarometricFormula)</code></pre><p>Calculates pressure at a given altitude using the barometric formula.</p><p>Implements Equation 1.5: p(z) = p_0 * exp(-z/H)</p><p>This is the integrated form of the hydrostatic equation for an isothermal atmosphere. The scale height H is provided as an input.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/seinfeld_pandis_ch1.jl#L190-L200">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.GaussianPGB-Tuple{}"><a class="docstring-binding" href="#EnvironmentalTransport.GaussianPGB-Tuple{}"><code>EnvironmentalTransport.GaussianPGB</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><p>GaussianPGB()</p><p>Return a <code>ModelingToolkit.System</code> implementing a classic Gaussian plume dispersion model, parameterized with Pasquill-Gifford-Briggs dispersion coefficients, following the formulations described in EPA guidance 402-R-00-004 ¬ß12.1.6 (https://19january2017snapshot.epa.gov/sites/production/files/2015-05/documents/402-r-00-004.pdf) and the MMGRMA document, Table 6-7 (https://www.epa.gov/sites/default/files/2020-10/documents/mmgrma_0.pdf). Good for: quasi-steady (piecewise-steady) applications where emissions and meteorology can be treated steady over each model time step; near-field ranges (typically ‚â§ 50 km); and cases where the effective plume height remains within the planetary boundary layer.</p><p>What this does:</p><ul><li><p>Stability classification: Uses near-surface meteorology (10 m wind speed, downward short-wave radiation, total cloud fraction, and the surface temperature lapse) to determine the Pasquill stability class.</p></li><li><p>Dispersion coefficients: Maps the stability class to Briggs coefficients (A<em>y, A</em>z, B<em>y, B</em>z) and evaluates the analytic expressions for the horizontal (sigma<em>h ‚â° sigma</em>y) and vertical (sigma_z) dispersion parameters as functions of the down-wind distance &#39;x&#39;.</p></li><li><p>Hypsometric height: Computes puff height above ground (z_agl) from pressure, temperature, and humidity using the hypsometric equation with a virtual temperature layer mean.</p></li><li><p>Ground-level concentration: Computes the Gaussian ground-level concentration at the puff center for one unit of puff mass: C<em>gl = 1 / ((2œÄ)^{3/2} ¬∑ œÉ</em>h¬≤ ¬∑ œÉ<em>z) * exp(-z</em>agl¬≤ / (2 œÉ_z¬≤)).</p></li></ul><p>Example:</p><pre><code class="language-julia hljs">using Dates, EarthSciMLBase, EarthSciData, EnvironmentalTransport
using ModelingToolkit, OrdinaryDiffEq

t0 = DateTime(2022, 5, 1)
t1 = DateTime(2022, 5, 2)
ŒîŒª      = deg2rad(5.0)
ŒîœÜ      = deg2rad(4.0)

dom = DomainInfo(t0, t1; levrange=1:72,
                    lonrange = deg2rad(-130):ŒîŒª:deg2rad(-60),
                    latrange = deg2rad(25):ŒîœÜ:deg2rad(61))

mdl = couple(Puff(dom),
             GEOSFP(&quot;4x5&quot;, dom; stream=false),
             GaussianPGB())

sys  = convert(System, mdl)

u0 = [sys.Puff‚Çälon =&gt; deg2rad(-105),
      sys.Puff‚Çälat =&gt; deg2rad(  38),
      sys.Puff‚Çälev =&gt; 2]

p  = [sys.GaussianPGB‚Çälon0 =&gt; deg2rad(-105),
      sys.GaussianPGB‚Çälat0 =&gt; deg2rad(  38)]

prob = ODEProblem(sys, u0, (datetime2unix(t0), datetime2unix(t1)), p)
sol = solve(prob, Tsit5();)

sigma_h = sol[sys.GaussianPGB‚Çäsigma_h]
sigma_z = sol[sys.GaussianPGB‚Çäsigma_z]
C_gl    = sol[sys.GaussianPGB‚ÇäC_gl]
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/GaussianDispersion.jl#L15-L80">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.GaussianSD-Tuple{}"><a class="docstring-binding" href="#EnvironmentalTransport.GaussianSD-Tuple{}"><code>EnvironmentalTransport.GaussianSD</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><p>GaussianSD()</p><p>Returns a <code>ModelingToolkit.System</code> that calculates horizontal dispersion (œÉ<em>h) from velocity deformation (Smagorinsky/Deardorff), and computes hypsometric height (z</em>agl) and ground-level centerline concentration per unit mass. The ground-level concentration is only evaluated when the puff is within the ground layer (z_agl ‚â§ Œîz); otherwise it is set to zero.</p><p>References (NOAA ARL MetMag report): https://www.arl.noaa.gov/documents/reports/MetMag.pdf</p><ul><li>Horizontal mixing coefficient: Eq. 12</li><li>Standard deviation of the turbulent velocity: Eq. 15</li><li>œÉ_h tendency: Eq. 16</li><li>Centerline ground-level concentration: Eq. 18</li></ul><p>Example:</p><pre><code class="language-julia hljs">using Dates, EarthSciMLBase, EarthSciData, EnvironmentalTransport
using ModelingToolkit, OrdinaryDiffEq

t0 = DateTime(2022, 5, 1)
t1 = DateTime(2022, 5, 2)
ŒîŒª      = deg2rad(5.0)
ŒîœÜ      = deg2rad(4.0)

dom = DomainInfo(t0, t1; levrange=1:72,
                    lonrange = deg2rad(-130):ŒîŒª:deg2rad(-60),
                    latrange = deg2rad(25):ŒîœÜ:deg2rad(61))

mdl = couple(Puff(dom),
             GEOSFP(&quot;4x5&quot;, dom; stream=false),
             GaussianSD())

sys  = convert(System, mdl)

u0 = [sys.Puff‚Çälon =&gt; deg2rad(-105),
      sys.Puff‚Çälat =&gt; deg2rad(  38),
      sys.Puff‚Çälev =&gt; 2,
      sys.GaussianSD‚Çäsigma_h =&gt; 0.0]

p = [
        sys.GaussianSD‚ÇäŒîŒª =&gt; ŒîŒª,
        sys.GaussianSD‚ÇäŒîœÜ =&gt; ŒîœÜ]

prob = ODEProblem(sys, u0, (datetime2unix(t0), datetime2unix(t1)), p)
sol = solve(prob, Tsit5();)

sigma_h = sol[sys.GaussianSD‚Çäsigma_h]
C_gl    = sol[sys.GaussianSD‚ÇäC_gl]
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/GaussianDispersion.jl#L292-L345">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.IdealGasLaw-Tuple{}"><a class="docstring-binding" href="#EnvironmentalTransport.IdealGasLaw-Tuple{}"><code>EnvironmentalTransport.IdealGasLaw</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">IdealGasLaw(; name=:IdealGasLaw)</code></pre><p>Calculates air density from pressure and temperature using the ideal gas law.</p><p>Implements Equation 1.2: rho = M_air * p / (R * T)</p><p>where:</p><ul><li>rho: air density (kg/m^3)</li><li>M_air: molecular weight of dry air (kg/mol)</li><li>p: atmospheric pressure (Pa)</li><li>R: universal gas constant (J/(mol*K))</li><li>T: temperature (K)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/seinfeld_pandis_ch1.jl#L52-L67">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.LocalScaleMeteorology-Tuple{}"><a class="docstring-binding" href="#EnvironmentalTransport.LocalScaleMeteorology-Tuple{}"><code>EnvironmentalTransport.LocalScaleMeteorology</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">LocalScaleMeteorology(; name=:LocalScaleMeteorology)</code></pre><p>Returns a <code>ModelingToolkit.System</code> combining atmospheric stability analysis with surface layer Monin-Obukhov similarity theory for comprehensive local-scale meteorological calculations.</p><p>Based on Chapter 16 &quot;Meteorology of the Local Scale&quot; from Seinfeld &amp; Pandis (2006) &quot;Atmospheric Chemistry and Physics&quot;, 2nd Edition, pp. 720-760.</p><p>This composite system includes:</p><ul><li>Potential temperature and stability classification</li><li>Dry adiabatic lapse rate</li><li>Monin-Obukhov length and stability parameter</li><li>Stability-corrected wind profiles</li><li>Pasquill stability class estimation (Table 16.4)</li></ul><p>Key equations:</p><ul><li>Eq. 16.8: Œì = g/ƒâ_p ‚âà 9.76 K/km (dry adiabatic lapse rate)</li><li>Eq. 16.14: Œ∏ = T(p‚ÇÄ/p)^0.286 (potential temperature)</li><li>Eq. 16.66: ≈´ = (u*/Œ∫)ln(z/z‚ÇÄ) (log wind profile)</li><li>Eq. 16.70: L = -œÅƒâ<em>p T‚ÇÄ u*¬≥/(Œ∫g qÃÑ</em>z) (Monin-Obukhov length)</li><li>Eq. 16.75: œÜ<em>m, œÜ</em>h (Businger-Dyer stability functions)</li><li>Eq. 16.83: 1/L = a + b¬∑log‚ÇÅ‚ÇÄ(z‚ÇÄ) (Golder correlation for Pasquill classes)</li></ul><p>Pasquill Stability Classes (Table 16.4):</p><ul><li>A: Very unstable (strong convection)</li><li>B: Moderately unstable</li><li>C: Slightly unstable</li><li>D: Neutral</li><li>E: Slightly stable</li><li>F: Moderately stable</li><li>G: Very stable (strong inversion)</li></ul><p>Example:</p><pre><code class="language-julia hljs">using ModelingToolkit, EnvironmentalTransport

met = LocalScaleMeteorology()
sys = mtkcompile(met)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/local_scale_meteorology.jl#L184-L225">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.MixingRatio-Tuple{}"><a class="docstring-binding" href="#EnvironmentalTransport.MixingRatio-Tuple{}"><code>EnvironmentalTransport.MixingRatio</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">MixingRatio(; name=:MixingRatio)</code></pre><p>Calculates the volume (mole) mixing ratio of a species.</p><p>Implements Equation 1.6: xi<em>i = c</em>i / c_total</p><p>The mixing ratio is dimensionless and typically expressed in ppm, ppb, or ppt.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/seinfeld_pandis_ch1.jl#L268-L277">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.PartialPressureMixingRatio-Tuple{}"><a class="docstring-binding" href="#EnvironmentalTransport.PartialPressureMixingRatio-Tuple{}"><code>EnvironmentalTransport.PartialPressureMixingRatio</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">PartialPressureMixingRatio(; name=:PartialPressureMixingRatio)</code></pre><p>Relates mixing ratio to partial pressure.</p><p>Implements Equation 1.8: xi<em>i = c</em>i / (p/(R*T)) = p_i / p</p><p>The mixing ratio equals the ratio of partial pressure to total pressure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/seinfeld_pandis_ch1.jl#L298-L307">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.Puff-Tuple{EarthSciMLBase.DomainInfo}"><a class="docstring-binding" href="#EnvironmentalTransport.Puff-Tuple{EarthSciMLBase.DomainInfo}"><code>EnvironmentalTransport.Puff</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">Puff(
    di::EarthSciMLBase.DomainInfo;
    buffer_cells,
    name
) -&gt; ModelingToolkit.System
</code></pre><p>Create a Lagrangian transport model which advects a &quot;puff&quot; or particle of matter within a fluid velocity field.</p><p>Model boundaries are set by the DomainInfo argument. The model sets boundaries at the ground and model bottom and top, preventing the puff from crossing those boundaries. If the puff reaches one of the horizontal boundaries, the simulation is stopped.</p><p><strong>Keyword arguments</strong></p><ul><li>buffer_cells: The distance (expressed in a number of DomainInfo grid cells) to use as a buffer around the horizontal edge of the domain to avoid data loader interpolation errors. The effective size of the domain will be reduce by 2√ó this amount (default = 1)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/puff.jl#L7">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.RelativeHumidity-Tuple{}"><a class="docstring-binding" href="#EnvironmentalTransport.RelativeHumidity-Tuple{}"><code>EnvironmentalTransport.RelativeHumidity</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">RelativeHumidity(; name=:RelativeHumidity)</code></pre><p>Calculates relative humidity from water vapor partial pressure and saturation vapor pressure.</p><p>Implements Equation 1.9: RH = 100 * p<em>H2O / p</em>H2O_sat</p><p>Relative humidity is expressed as a percentage (0-100%), stored as a dimensionless ratio multiplied by 100.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/seinfeld_pandis_ch1.jl#L385-L396">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.SaturationVaporPressure-Tuple{}"><a class="docstring-binding" href="#EnvironmentalTransport.SaturationVaporPressure-Tuple{}"><code>EnvironmentalTransport.SaturationVaporPressure</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">SaturationVaporPressure(; name=:SaturationVaporPressure)</code></pre><p>Calculates the saturation vapor pressure of water as a function of temperature.</p><p>Implements Equation 1.10: p<em>H2O</em>sat(T) = 1013.25 * exp(13.3185<em>a - 1.9760</em>a^2 - 0.6445<em>a^3 - 0.1299</em>a^4)</p><p>where: a = 1 - 373.15/T</p><p>This empirical formula is valid for liquid water (T &gt; 273 K).</p><p>Note: The original equation gives pressure in mbar. Here we convert to Pa for consistency with SI units: p<em>sat (Pa) = 100 * p</em>sat (mbar)</p><p>Reference values:</p><ul><li>At T = 273 K: p_sat ~ 611 Pa (6.1 mbar)</li><li>At T = 298 K: p_sat ~ 3170 Pa (31.7 mbar)</li><li>At T = 373 K: p_sat = 101325 Pa (1013.25 mbar, boiling point)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/seinfeld_pandis_ch1.jl#L329-L350">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.ScaleHeight-Tuple{}"><a class="docstring-binding" href="#EnvironmentalTransport.ScaleHeight-Tuple{}"><code>EnvironmentalTransport.ScaleHeight</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">ScaleHeight(; name=:ScaleHeight)</code></pre><p>Calculates the atmospheric scale height.</p><p>Implements Equation 1.4: H = R * T / (M_air * g)</p><p>The scale height H represents the altitude increase over which pressure decreases by a factor of e (~2.718).</p><p>Typical values:</p><ul><li>At T = 253 K: H = 7.4 km</li><li>At T = 288 K (sea level): H = 8.4 km</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/seinfeld_pandis_ch1.jl#L93-L108">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.Sofiev2012PlumeRise-Tuple{}"><a class="docstring-binding" href="#EnvironmentalTransport.Sofiev2012PlumeRise-Tuple{}"><code>EnvironmentalTransport.Sofiev2012PlumeRise</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><p>Wildfire plume rise model based on Sofiev et al. (2012) [1].</p><p>[1] Sofiev, M., Ermakova, T., and Vankevich, R.: Evaluation of the smoke-injection height from wild-land fires using remote-sensing data, Atmos. Chem. Phys., 12, 1995‚Äì2006, https://doi.org/10.5194/acp-12-1995-2012, 2012.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/plume_rise/sofiev_2012.jl#L7-L13">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.SurfaceLayerProfile-Tuple{}"><a class="docstring-binding" href="#EnvironmentalTransport.SurfaceLayerProfile-Tuple{}"><code>EnvironmentalTransport.SurfaceLayerProfile</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">SurfaceLayerProfile(; name=:SurfaceLayerProfile)</code></pre><p>Returns a <code>ModelingToolkit.System</code> implementing Monin-Obukhov similarity theory for the atmospheric surface layer, including logarithmic wind profiles and stability corrections.</p><p>Based on Chapter 16 &quot;Meteorology of the Local Scale&quot; from Seinfeld &amp; Pandis (2006) &quot;Atmospheric Chemistry and Physics&quot;, 2nd Edition, pp. 720-760.</p><p>Key equations implemented:</p><ul><li>Eq. 16.66: Logarithmic wind profile ≈´(z) = (u*/Œ∫)ln(z/z‚ÇÄ)</li><li>Eq. 16.70: Monin-Obukhov length L = -œÅƒâ<em>p T‚ÇÄ u*¬≥/(Œ∫g qÃÑ</em>z)</li><li>Eq. 16.75: Businger-Dyer stability functions œÜ<em>m, œÜ</em>h</li><li>Eq. 16.78-16.79: Integrated stability functions œà<em>m, œà</em>h</li></ul><p>The system computes:</p><ul><li>Mean wind speed at height z with stability corrections</li><li>Friction velocity u*</li><li>Sensible heat flux</li><li>Stability-corrected profiles for momentum and heat</li></ul><p>Example:</p><pre><code class="language-julia hljs">using ModelingToolkit, EnvironmentalTransport

surf = SurfaceLayerProfile()
sys = mtkcompile(surf)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/local_scale_meteorology.jl#L77-L106">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.TotalMolarConcentration-Tuple{}"><a class="docstring-binding" href="#EnvironmentalTransport.TotalMolarConcentration-Tuple{}"><code>EnvironmentalTransport.TotalMolarConcentration</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">TotalMolarConcentration(; name=:TotalMolarConcentration)</code></pre><p>Calculates total molar concentration of air from pressure and temperature.</p><p>Implements Equation 1.7: c_total = N/V = p / (R * T)</p><p>Standard values:</p><ul><li>At STP (T=273.15 K, p=101325 Pa): c_total = 44.6 mol/m^3</li><li>At T=298 K, p=101325 Pa: c_total = 40.9 mol/m^3</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/seinfeld_pandis_ch1.jl#L231-L243">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.WaterVaporThermodynamics-Tuple{}"><a class="docstring-binding" href="#EnvironmentalTransport.WaterVaporThermodynamics-Tuple{}"><code>EnvironmentalTransport.WaterVaporThermodynamics</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">WaterVaporThermodynamics(; name=:WaterVaporThermodynamics)</code></pre><p>Complete water vapor thermodynamics system combining:</p><ul><li>Equation 1.10: Saturation vapor pressure</li><li>Equation 1.9: Relative humidity</li></ul><p>This composite system calculates relative humidity given temperature and water vapor partial pressure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/seinfeld_pandis_ch1.jl#L422-L432">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.advection_kernel_4d"><a class="docstring-binding" href="#EnvironmentalTransport.advection_kernel_4d"><code>EnvironmentalTransport.advection_kernel_4d</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><p>An advection kernel for a 4D array, where the first dimension is the state variables and the next three dimensions are the spatial dimensions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/advection.jl#L3-L6">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.advection_op-Tuple{Any, Any, Any, Any, Any, Any, EarthSciMLBase.MapAlgorithm}"><a class="docstring-binding" href="#EnvironmentalTransport.advection_op-Tuple{Any, Any, Any, Any, Any, Any, EarthSciMLBase.MapAlgorithm}"><code>EnvironmentalTransport.advection_op</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><p>A function to create an advection operator for a 4D array,</p><p>Arguments:</p><ul><li><code>u_prototype</code>: A prototype array of the same size and type as the input array.</li><li><code>stencil</code>: The stencil operator, e.g. <code>l94_stencil</code> or <code>ppm_stencil</code>.</li><li><code>v_fs</code>: A vector of functions to get the wind velocity at a given place and time. The function signature should be <code>v_fs(i, j, k, t)</code>.</li><li><code>Œî_fs</code>: A vector of functions to get the grid spacing at a given place and time. The function signature should be <code>Œî_fs(i, j, k, t)</code>.</li><li><code>Œît</code>: The time step size, which is assumed to be fixed.</li><li><code>bc_type</code>: The boundary condition type, e.g. <code>ZeroGradBC()</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/advection.jl#L43-L56">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.air_mass_from_pressure-Tuple{Vector{Float64}, Float64}"><a class="docstring-binding" href="#EnvironmentalTransport.air_mass_from_pressure-Tuple{Vector{Float64}, Float64}"><code>EnvironmentalTransport.air_mass_from_pressure</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><p>Compute air mass for each layer from pressure edges and grid area.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/PBL_mixing.jl#L97-L99">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.compute_imix_fpbl-Tuple{Vector{Float64}, Float64}"><a class="docstring-binding" href="#EnvironmentalTransport.compute_imix_fpbl-Tuple{Vector{Float64}, Float64}"><code>EnvironmentalTransport.compute_imix_fpbl</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><p>Compute PBL mixing parameters based on domain levels.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/PBL_mixing.jl#L64-L66">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.extract_domain_pressure_edges-Tuple{AbstractRange}"><a class="docstring-binding" href="#EnvironmentalTransport.extract_domain_pressure_edges-Tuple{AbstractRange}"><code>EnvironmentalTransport.extract_domain_pressure_edges</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><p>Extract domain-specific pressure edges from the pre-computed 73-level GEOS-FP grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/PBL_mixing.jl#L48-L50">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.get_vf-Tuple{Any, AbstractString, Any}"><a class="docstring-binding" href="#EnvironmentalTransport.get_vf-Tuple{Any, AbstractString, Any}"><code>EnvironmentalTransport.get_vf</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_vf(domain, varname, data_f)
</code></pre><p>Return a function that gets the wind velocity at a given place and time for the given <code>varname</code>. <code>data_f</code> should be a function that takes a time and three spatial coordinates and returns the value of the wind speed in the direction indicated by <code>varname</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/advection.jl#L118">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.get_Œî-Tuple{EarthSciMLBase.DomainInfo, Any, Any}"><a class="docstring-binding" href="#EnvironmentalTransport.get_Œî-Tuple{EarthSciMLBase.DomainInfo, Any, Any}"><code>EnvironmentalTransport.get_Œî</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_Œî(domain, tff, pvaridx)
</code></pre><p>Return a function that gets the grid spacing at a given place and time for the given <code>varname</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/advection.jl#L154">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.pbl_full_mix!-Tuple{Matrix{Float64}, Vector{Float64}, Int64, Float64}"><a class="docstring-binding" href="#EnvironmentalTransport.pbl_full_mix!-Tuple{Matrix{Float64}, Vector{Float64}, Int64, Float64}"><code>EnvironmentalTransport.pbl_full_mix!</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><p>Apply full PBL mixing to tracer concentrations (GEOS-Chem TURBDAY algorithm).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/PBL_mixing.jl#L110-L112">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.pbl_obs_function-NTuple{4, Any}"><a class="docstring-binding" href="#EnvironmentalTransport.pbl_obs_function-NTuple{4, Any}"><code>EnvironmentalTransport.pbl_obs_function</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">pbl_obs_function(mtk_sys, coord_args, v, T)</code></pre><p>Create an observed function for extracting data from the ModelingToolkit system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/PBL_mixing.jl#L153-L157">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.resolve_species_bc-Tuple{SpeciesConstantBC, Any, Any}"><a class="docstring-binding" href="#EnvironmentalTransport.resolve_species_bc-Tuple{SpeciesConstantBC, Any, Any}"><code>EnvironmentalTransport.resolve_species_bc</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">resolve_species_bc(bc, x, species_vars)
</code></pre><p>Helper function to resolve species names to indices and create a SpeciesConstantBCArray. This is used by AdvectionOperator when species information is available.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/boundary_conditions.jl#L146">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.stencil_size-Tuple{typeof(upwind1_stencil)}"><a class="docstring-binding" href="#EnvironmentalTransport.stencil_size-Tuple{typeof(upwind1_stencil)}"><code>EnvironmentalTransport.stencil_size</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><p>Return the left and right stencil size of the first-order upwind stencil.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/advection_stencils.jl#L186-L188">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.upwind1_stencil-NTuple{4, Any}"><a class="docstring-binding" href="#EnvironmentalTransport.upwind1_stencil-NTuple{4, Any}"><code>EnvironmentalTransport.upwind1_stencil</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">upwind1_stencil(œï, U, Œît, Œîz; p)
</code></pre><p>First-order upwind advection in 1-D: https://en.wikipedia.org/wiki/Upwind_scheme.</p><ul><li>œï is the scalar field at the current time step, it should be a vector of length 3 (1 cell on the left, the central cell, and 1 cell on the right).</li><li>U is the velocity at both edges of the central grid cell, it should be a vector of length 2.</li><li>Œît is the length of the time step.</li><li>Œîz is the grid spacing.</li></ul><p>The output will be time derivative of the central index (i.e. index 2) of the œï vector (i.e. dœï/dt).</p><p><code>Œît</code> and <code>p</code> are not used, but are function arguments for consistency with other operators.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/advection_stencils.jl#L160">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.vf_x-Tuple{Any, Any}"><a class="docstring-binding" href="#EnvironmentalTransport.vf_x-Tuple{Any, Any}"><code>EnvironmentalTransport.vf_x</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><p>Get a value from the x-direction velocity field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/advection.jl#L81-L83">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.vf_y-Tuple{Any, Any}"><a class="docstring-binding" href="#EnvironmentalTransport.vf_y-Tuple{Any, Any}"><code>EnvironmentalTransport.vf_y</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><p>Get a value from the y-direction velocity field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/advection.jl#L93-L95">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.vf_z-Tuple{Any, Any}"><a class="docstring-binding" href="#EnvironmentalTransport.vf_z-Tuple{Any, Any}"><code>EnvironmentalTransport.vf_z</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><p>Get a value from the z-direction velocity field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/advection.jl#L105-L107">source</a></section></details></article><article><details class="docstring" open="true"><summary id="EnvironmentalTransport.Œîf-Tuple{Any, Any}"><a class="docstring-binding" href="#EnvironmentalTransport.Œîf-Tuple{Any, Any}"><code>EnvironmentalTransport.Œîf</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><p>function to get grid deltas.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/EnvironmentalTransport.jl/blob/2a6008e49b2cd527e4e3754d98821479e5f0a6b2/src/advection.jl#L144-L146">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../local_scale_meteorology/">¬´ Local Scale Meteorology</a><a class="docs-footer-nextpage" href="../benchmarks/">üîó Benchmarks ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 4 February 2026 20:08">Wednesday 4 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
